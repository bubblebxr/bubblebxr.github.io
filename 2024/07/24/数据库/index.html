<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="数据库"><meta name="keywords" content="笔记,数据库"><meta name="author" content="bubble"><meta name="copyright" content="bubble"><title>数据库 | bubble's blog</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://v1.hitokoto.cn/?encode=js&amp;charset=utf-8&amp;select=.footer_custom_text" defer></script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  hexoVersion: '7.3.0'
} </script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="bubble's blog" type="application/atom+xml">
</head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="true"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#01-%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text"> 01 数据管理基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.</span> <span class="toc-text"> 数据管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 数据库系统</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#02-%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text"> 02 数据模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.1.</span> <span class="toc-text"> 概念模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#er%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.1.1.</span> <span class="toc-text"> ER数据模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8A%BD%E8%B1%A1%E6%89%8B%E6%AE%B5"><span class="toc-number">2.1.1.1.</span> <span class="toc-text"> 抽象手段</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-number">2.1.1.1.1.</span> <span class="toc-text"> 分类</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%81%9A%E9%9B%86"><span class="toc-number">2.1.1.1.2.</span> <span class="toc-text"> 聚集</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%85%83%E7%B4%A0"><span class="toc-number">2.1.1.2.</span> <span class="toc-text"> 基本元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#er%E5%9B%BE"><span class="toc-number">2.1.1.3.</span> <span class="toc-text"> ER图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.1.1.4.</span> <span class="toc-text"> 约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">2.1.1.4.1.</span> <span class="toc-text"> 键约束</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BB%BA%E6%A8%A1%E5%87%86%E5%88%99"><span class="toc-number">2.1.1.5.</span> <span class="toc-text"> 建模准则</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text"> 逻辑模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E6%A8%A1%E5%9E%8B"><span class="toc-number">2.3.</span> <span class="toc-text"> 物理模型</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#03-%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B"><span class="toc-number">3.</span> <span class="toc-text"> 03 关系模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-number">3.1.</span> <span class="toc-text"> 关系数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#er%E6%A8%A1%E5%9E%8B%E5%90%91%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E8%BD%AC%E5%8C%96"><span class="toc-number">3.1.2.</span> <span class="toc-text"> ER模型向关系模型转化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.1.2.1.</span> <span class="toc-text"> 实体类型转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E5%85%83%E8%81%94%E7%B3%BB%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.1.2.2.</span> <span class="toc-text"> 二元联系类型的转换</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number">3.2.</span> <span class="toc-text"> 关系的完整性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0"><span class="toc-number">3.3.</span> <span class="toc-text"> 关系代数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">3.3.1.</span> <span class="toc-text"> 集合运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%93%E9%97%A8%E7%9A%84%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">3.3.2.</span> <span class="toc-text"> 专门的关系运算符</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#04-sql%E8%AF%AD%E8%A8%80"><span class="toc-number">4.</span> <span class="toc-text"> 04 SQL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80"><span class="toc-number">4.1.</span> <span class="toc-text"> 查询语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.1.</span> <span class="toc-text"> 单表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%88%97"><span class="toc-number">4.1.1.1.</span> <span class="toc-text"> 选择列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E7%BB%8F%E8%AE%A1%E7%AE%97%E7%9A%84%E5%80%BC"><span class="toc-number">4.1.1.2.</span> <span class="toc-text"> 查询经计算的值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%85%83%E7%BB%84"><span class="toc-number">4.1.1.3.</span> <span class="toc-text"> 选择元组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">4.1.1.4.</span> <span class="toc-text"> 排序</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E5%92%8C%E5%88%86%E7%BB%84"><span class="toc-number">4.1.2.</span> <span class="toc-text"> 聚集和分组</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E9%9B%86-2"><span class="toc-number">4.1.2.1.</span> <span class="toc-text"> 聚集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#group-by"><span class="toc-number">4.1.2.2.</span> <span class="toc-text"> GROUP BY</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#having"><span class="toc-number">4.1.2.3.</span> <span class="toc-text"> Having</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.3.</span> <span class="toc-text"> 多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.3.1.</span> <span class="toc-text"> 连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-number">4.1.3.1.1.</span> <span class="toc-text"> 笛卡尔积</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-number">4.1.3.1.2.</span> <span class="toc-text"> 等值连接</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.4.</span> <span class="toc-text"> 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6in%E8%B0%93%E8%AF%8D%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.4.1.</span> <span class="toc-text"> 带IN谓词的子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E6%9C%89any%E6%88%96all%E8%B0%93%E8%AF%8D%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.4.2.</span> <span class="toc-text"> 带有ANY或ALL谓词的子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%A6%E6%9C%89exists%E8%B0%93%E8%AF%8D%E7%9A%84%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.4.3.</span> <span class="toc-text"> 带有EXISTS谓词的子查询</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">4.1.5.</span> <span class="toc-text"> 集合查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ddl%E8%AF%AD%E8%A8%80"><span class="toc-number">4.2.</span> <span class="toc-text"> DDL语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%A1%A8"><span class="toc-number">4.2.1.</span> <span class="toc-text"> 基本表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E8%A1%A8"><span class="toc-number">4.2.1.1.</span> <span class="toc-text"> 定义表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="toc-number">4.2.1.2.</span> <span class="toc-text"> 删除表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8"><span class="toc-number">4.2.1.3.</span> <span class="toc-text"> 修改表</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dml%E8%AF%AD%E8%A8%80"><span class="toc-number">4.3.</span> <span class="toc-text"> DML语言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5"><span class="toc-number">4.3.1.</span> <span class="toc-text"> 插入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0"><span class="toc-number">4.3.2.</span> <span class="toc-text"> 更新</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">4.3.3.</span> <span class="toc-text"> 删除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dcl%E8%AF%AD%E8%A8%80"><span class="toc-number">4.4.</span> <span class="toc-text"> DCL语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE"><span class="toc-number">4.5.</span> <span class="toc-text"> 视图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#05-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B"><span class="toc-number">5.</span> <span class="toc-text"> 05 数据库编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%85%E9%83%A8%E7%BC%96%E7%A8%8B"><span class="toc-number">5.1.</span> <span class="toc-text"> 数据库内部编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">5.1.1.</span> <span class="toc-text"> 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">5.1.1.1.</span> <span class="toc-text"> 变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-number">5.1.1.2.</span> <span class="toc-text"> 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#if"><span class="toc-number">5.1.1.2.1.</span> <span class="toc-text"> if</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#case"><span class="toc-number">5.1.1.2.2.</span> <span class="toc-text"> case</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#while"><span class="toc-number">5.1.1.2.3.</span> <span class="toc-text"> while</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#repeat"><span class="toc-number">5.1.1.2.4.</span> <span class="toc-text"> repeat</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#loop"><span class="toc-number">5.1.1.2.5.</span> <span class="toc-text"> loop</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E5%87%BD%E6%95%B0%E4%B8%8E%E5%91%BD%E4%BB%A4"><span class="toc-number">5.1.1.3.</span> <span class="toc-text"> 常用数据库函数与命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B5%8C%E5%85%A5%E5%BC%8Fsql"><span class="toc-number">5.1.1.4.</span> <span class="toc-text"> 嵌入式SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81sql"><span class="toc-number">5.1.1.5.</span> <span class="toc-text"> 动态SQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E7%BC%96%E7%A8%8B"><span class="toc-number">5.1.1.6.</span> <span class="toc-text"> 游标编程</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.2.</span> <span class="toc-text"> 函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number">5.1.3.</span> <span class="toc-text"> 触发器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#06-%E5%AD%98%E5%82%A8%E4%B8%8E%E7%B4%A2%E5%BC%95"><span class="toc-number">6.</span> <span class="toc-text"> 06 存储与索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8"><span class="toc-number">6.1.</span> <span class="toc-text"> 存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.1.</span> <span class="toc-text"> 逻辑组织结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E9%A1%B5%E9%9D%A2%E7%BB%84%E7%BB%87%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.2.</span> <span class="toc-text"> 物理页面组织结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">6.2.</span> <span class="toc-text"> 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#b%E6%A0%91"><span class="toc-number">6.2.1.</span> <span class="toc-text"> B树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#b%E6%A0%91%E7%B4%A2%E5%BC%95"><span class="toc-number">6.2.2.</span> <span class="toc-text"> B+树索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%9B%B4%E6%96%B0"><span class="toc-number">6.2.2.1.</span> <span class="toc-text"> 索引更新</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hash%E7%B4%A2%E5%BC%95"><span class="toc-number">6.2.3.</span> <span class="toc-text"> Hash索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95"><span class="toc-number">6.2.4.</span> <span class="toc-text"> 聚簇索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">6.2.5.</span> <span class="toc-text"> 联合索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">6.2.6.</span> <span class="toc-text"> 查询优化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#07-%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.</span> <span class="toc-text"> 07 完整性约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E6%8E%A7%E5%88%B6%E6%9C%BA%E5%88%B6"><span class="toc-number">7.1.</span> <span class="toc-text"> 完整性控制机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E8%A7%84%E5%88%99"><span class="toc-number">7.1.1.</span> <span class="toc-text"> 完整性规则</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6"><span class="toc-number">7.2.</span> <span class="toc-text"> 完整性约束条件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-2"><span class="toc-number">7.2.1.</span> <span class="toc-text"> 分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%B1%BB1"><span class="toc-number">7.2.1.1.</span> <span class="toc-text"> 分类1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%B1%BB2"><span class="toc-number">7.2.1.2.</span> <span class="toc-text"> 分类2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9D%E7%BA%A6%E5%8F%8D%E5%BA%94"><span class="toc-number">7.3.</span> <span class="toc-text"> 违约反应</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E5%85%83%E7%BB%84"><span class="toc-number">7.3.1.</span> <span class="toc-text"> 删除元组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%85%83%E7%BB%84"><span class="toc-number">7.3.2.</span> <span class="toc-text"> 插入元组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%85%83%E7%BB%84"><span class="toc-number">7.3.3.</span> <span class="toc-text"> 修改元组</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#08-%E5%AE%89%E5%85%A8"><span class="toc-number">8.</span> <span class="toc-text"> 08 安全</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E5%85%A8%E8%AE%A4%E8%AF%81"><span class="toc-number">8.1.</span> <span class="toc-text"> 安全认证</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%A4%E8%AF%81"><span class="toc-number">8.1.1.</span> <span class="toc-text"> 数据库认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%83%A8%E8%AE%A4%E8%AF%81"><span class="toc-number">8.1.2.</span> <span class="toc-text"> 外部认证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">8.2.</span> <span class="toc-text"> 访问控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-3"><span class="toc-number">8.2.1.</span> <span class="toc-text"> 分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">8.2.2.</span> <span class="toc-text"> 权限控制语句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%92%E8%89%B2"><span class="toc-number">8.2.2.1.</span> <span class="toc-text"> 角色</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#09-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">9.</span> <span class="toc-text"> 09 事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%B9%B6%E5%8F%91%E6%89%A7%E8%A1%8C"><span class="toc-number">9.1.</span> <span class="toc-text"> 事务的并发执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%8A%B6%E6%80%81"><span class="toc-number">9.1.1.</span> <span class="toc-text"> 执行状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E6%93%8D%E4%BD%9C%E5%B8%A6%E6%9D%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%8D%E4%B8%80%E8%87%B4%E6%80%A7"><span class="toc-number">9.1.2.</span> <span class="toc-text"> 并发操作带来的数据不一致性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B9%B6%E5%8F%91%E6%8E%A7%E5%88%B6%E6%9C%BA%E5%88%B6"><span class="toc-number">9.2.</span> <span class="toc-text"> 并发控制机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%83%E5%BA%A6"><span class="toc-number">9.2.1.</span> <span class="toc-text"> 调度</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%B2%E7%AA%81%E5%8F%AF%E4%B8%B2%E8%A1%8C%E5%8C%96"><span class="toc-number">9.2.1.1.</span> <span class="toc-text"> 冲突可串行化</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%89%8D%E9%A9%B1%E5%9B%BE"><span class="toc-number">9.2.1.1.1.</span> <span class="toc-text"> 前驱图</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E6%81%A2%E5%A4%8D"><span class="toc-number">9.2.1.2.</span> <span class="toc-text"> 可恢复</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E6%BB%9A"><span class="toc-number">9.2.1.3.</span> <span class="toc-text"> 回滚</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%81"><span class="toc-number">9.2.2.</span> <span class="toc-text"> 锁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.2.1.</span> <span class="toc-text"> 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E7%BA%A7%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.2.1.1.</span> <span class="toc-text"> 一级封锁协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.2.1.2.</span> <span class="toc-text"> 二级封锁协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%89%E7%BA%A7%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.2.1.3.</span> <span class="toc-text"> 三级封锁协议</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">9.2.2.1.4.</span> <span class="toc-text"> 事务隔离级别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E9%98%B6%E6%AE%B5%E5%B0%81%E9%94%81%E5%8D%8F%E8%AE%AE2pl"><span class="toc-number">9.2.3.</span> <span class="toc-text"> 两阶段封锁协议2PL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A5%E6%A0%BC%E7%9A%84%E4%B8%A4%E6%AE%B5%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">9.2.3.1.</span> <span class="toc-text"> 严格的两段锁协议</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%BB%E9%94%81"><span class="toc-number">9.3.</span> <span class="toc-text"> 死锁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%84%E9%98%B2"><span class="toc-number">9.3.1.</span> <span class="toc-text"> 预防</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%8A%E6%96%AD%E4%B8%8E%E8%A7%A3%E9%99%A4"><span class="toc-number">9.3.2.</span> <span class="toc-text"> 诊断与解除</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-number">10.</span> <span class="toc-text"> 10 备份与恢复</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-4"><span class="toc-number">10.1.</span> <span class="toc-text"> 分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D"><span class="toc-number">10.1.1.</span> <span class="toc-text"> 逻辑备份恢复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D"><span class="toc-number">10.1.2.</span> <span class="toc-text"> 物理备份恢复</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E5%A4%84%E7%90%86%E7%AD%96%E7%95%A5"><span class="toc-number">10.2.</span> <span class="toc-text"> 缓冲区处理策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#no-stealforce"><span class="toc-number">10.2.1.</span> <span class="toc-text"> No Steal+Force</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%8A%80%E6%9C%AF"><span class="toc-number">10.3.</span> <span class="toc-text"> 恢复实现的技术</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%85%E9%9A%9C%E5%88%86%E7%B1%BB"><span class="toc-number">10.3.1.</span> <span class="toc-text"> 故障分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E6%95%85%E9%9A%9C"><span class="toc-number">10.3.1.1.</span> <span class="toc-text"> 事务故障</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%95%85%E9%9A%9C"><span class="toc-number">10.3.1.2.</span> <span class="toc-text"> 系统故障</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8B%E8%B4%A8%E6%95%85%E9%9A%9C"><span class="toc-number">10.3.1.3.</span> <span class="toc-text"> 介质故障</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E6%8A%80%E6%9C%AF"><span class="toc-number">10.3.2.</span> <span class="toc-text"> 恢复技术</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E8%BD%AC%E5%82%A8"><span class="toc-number">10.3.2.1.</span> <span class="toc-text"> 数据转储</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">10.3.2.2.</span> <span class="toc-text"> 登录日志文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%90%8C%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%81%A2%E5%A4%8D"><span class="toc-number">10.3.2.3.</span> <span class="toc-text"> 不同模式的恢复</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5"><span class="toc-number">10.3.3.</span> <span class="toc-text"> 恢复策略</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Eundo%E6%97%A5%E5%BF%97%E7%9A%84%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5"><span class="toc-number">10.3.3.1.</span> <span class="toc-text"> 基于Undo日志的恢复策略</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E5%AE%B9"><span class="toc-number">10.3.3.1.1.</span> <span class="toc-text"> 内容</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%84%E5%88%99"><span class="toc-number">10.3.3.1.2.</span> <span class="toc-text"> 规则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E6%80%9D%E8%B7%AF"><span class="toc-number">10.3.3.1.3.</span> <span class="toc-text"> 恢复思路</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Eredo%E6%97%A5%E5%BF%97%E7%9A%84%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5"><span class="toc-number">10.3.3.2.</span> <span class="toc-text"> 基于Redo日志的恢复策略</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E5%AE%B9-2"><span class="toc-number">10.3.3.2.1.</span> <span class="toc-text"> 内容</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%84%E5%88%99-2"><span class="toc-number">10.3.3.2.2.</span> <span class="toc-text"> 规则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E6%80%9D%E8%B7%AF-2"><span class="toc-number">10.3.3.2.3.</span> <span class="toc-text"> 恢复思路</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%8Eundo%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-number">10.3.3.2.4.</span> <span class="toc-text"> 与Undo的比较</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8Eundoredo%E7%9A%84%E6%97%A5%E5%BF%97%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5"><span class="toc-number">10.3.3.3.</span> <span class="toc-text"> 基于Undo&#x2F;Redo的日志恢复策略</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E5%AE%B9-3"><span class="toc-number">10.3.3.3.1.</span> <span class="toc-text"> 内容</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A7%84%E5%88%99-3"><span class="toc-number">10.3.3.3.2.</span> <span class="toc-text"> 规则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%81%A2%E5%A4%8D%E6%80%9D%E8%B7%AF-3"><span class="toc-number">10.3.3.3.3.</span> <span class="toc-text"> 恢复思路</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%A3%80%E6%9F%A5%E7%82%B9%E7%9A%84%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5"><span class="toc-number">10.3.3.4.</span> <span class="toc-text"> 基于检查点的恢复策略</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%85%B3%E7%B3%BB%E6%95%B0%E6%8D%AE%E7%90%86%E8%AE%BA"><span class="toc-number">11.</span> <span class="toc-text"> 11 关系数据理论</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96"><span class="toc-number">11.1.</span> <span class="toc-text"> 函数依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-number">11.1.1.</span> <span class="toc-text"> 说明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-5"><span class="toc-number">11.1.2.</span> <span class="toc-text"> 分类</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%80%99%E9%80%89%E9%94%AE"><span class="toc-number">11.1.2.1.</span> <span class="toc-text"> 定义候选键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%A4%96%E9%94%AE"><span class="toc-number">11.1.2.2.</span> <span class="toc-text"> 定义外键</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8C%83%E5%BC%8F"><span class="toc-number">11.2.</span> <span class="toc-text"> 范式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1nf"><span class="toc-number">11.2.1.</span> <span class="toc-text"> 1NF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2nf"><span class="toc-number">11.2.2.</span> <span class="toc-text"> 2NF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%84%E8%8C%83%E5%8C%96%E6%8A%95%E5%BD%B1%E5%88%86%E8%A7%A3"><span class="toc-number">11.2.2.1.</span> <span class="toc-text"> 规范化—投影分解</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3nf"><span class="toc-number">11.2.3.</span> <span class="toc-text"> 3NF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bcnf"><span class="toc-number">11.2.4.</span> <span class="toc-text"> BCNF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E8%8C%83%E5%8C%96"><span class="toc-number">11.2.5.</span> <span class="toc-text"> 规范化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%84%E8%8C%83%E5%8C%96%E6%AD%A5%E9%AA%A4"><span class="toc-number">11.2.5.1.</span> <span class="toc-text"> 规范化步骤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E8%A7%84%E8%8C%83%E5%8C%96%E8%AE%BE%E8%AE%A1"><span class="toc-number">11.2.5.2.</span> <span class="toc-text"> 非规范化设计</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0%E5%86%97%E4%BD%99%E5%88%97"><span class="toc-number">11.2.5.2.1.</span> <span class="toc-text"> 增加冗余列</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0%E6%B4%BE%E7%94%9F%E5%88%97"><span class="toc-number">11.2.5.2.2.</span> <span class="toc-text"> 增加派生列</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E7%BB%84%E8%A1%A8"><span class="toc-number">11.2.5.2.3.</span> <span class="toc-text"> 重新组表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8"><span class="toc-number">11.2.5.2.4.</span> <span class="toc-text"> 分库分表</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E5%88%86%E8%A7%A3"><span class="toc-number">11.3.</span> <span class="toc-text"> 模式分解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BE%9D%E8%B5%96%E7%9A%84%E5%85%AC%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">11.3.1.</span> <span class="toc-text"> 数据依赖的公理系统</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#armstrong%E5%85%AC%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-number">11.3.1.1.</span> <span class="toc-text"> Armstrong公理系统</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E9%97%AD%E5%8C%85"><span class="toc-number">11.3.1.2.</span> <span class="toc-text"> 函数依赖闭包</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E9%9B%86%E7%9A%84%E9%97%AD%E5%8C%85"><span class="toc-number">11.3.1.2.1.</span> <span class="toc-text"> 属性集的闭包</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E4%BE%9D%E8%B5%96%E9%9B%86"><span class="toc-number">11.3.1.3.</span> <span class="toc-text"> 最小依赖集</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E5%88%86%E8%A7%A3%E7%9A%84%E5%88%A4%E5%AE%9A%E4%BE%9D%E6%8D%AE"><span class="toc-number">11.3.2.</span> <span class="toc-text"> 模式分解的判定依据</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%A0%E6%8D%9F%E8%BF%9E%E6%8E%A5%E6%80%A7"><span class="toc-number">11.3.2.1.</span> <span class="toc-text"> 无损连接性</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%B3%95"><span class="toc-number">11.3.2.1.1.</span> <span class="toc-text"> 列表法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E7%90%86%E6%B3%95"><span class="toc-number">11.3.2.1.2.</span> <span class="toc-text"> 定理法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%9D%E6%8C%81%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96"><span class="toc-number">11.3.2.2.</span> <span class="toc-text"> 保持函数依赖</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">12.</span> <span class="toc-text"> 12 数据库设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">12.1.</span> <span class="toc-text"> 概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82%E5%88%86%E6%9E%90"><span class="toc-number">12.2.</span> <span class="toc-text"> 需求分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B5%81%E5%9B%BE"><span class="toc-number">12.2.1.</span> <span class="toc-text"> 数据流图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AD%97%E5%85%B8"><span class="toc-number">12.2.2.</span> <span class="toc-text"> 数据字典</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">12.3.</span> <span class="toc-text"> 概念结构设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84%E8%AE%BE%E8%AE%A1"><span class="toc-number">12.4.</span> <span class="toc-text"> 逻辑结构设计</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-nosql%E4%B8%8E%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">13.</span> <span class="toc-text"> 13 NoSQL与云数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">13.1.</span> <span class="toc-text"> 分布式数据库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%B7%E6%BA%90bigtable"><span class="toc-number">13.1.1.</span> <span class="toc-text"> 起源—BigTable</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hbase%E6%A6%82%E8%BF%B0"><span class="toc-number">13.1.2.</span> <span class="toc-text"> HBase概述</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nosql%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">13.2.</span> <span class="toc-text"> NoSQL非关系型数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nosql%E6%8A%80%E6%9C%AF%E7%89%B9%E7%82%B9"><span class="toc-number">13.3.</span> <span class="toc-text"> NoSQL技术特点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nosql%E4%B8%89%E5%A4%A7%E5%9F%BA%E7%9F%B3"><span class="toc-number">13.3.1.</span> <span class="toc-text"> NoSQL三大基石</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#cap"><span class="toc-number">13.3.1.1.</span> <span class="toc-text"> CAP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#base"><span class="toc-number">13.3.1.2.</span> <span class="toc-text"> BASE</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%91%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">13.4.</span> <span class="toc-text"> 云数据库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#final"><span class="toc-number">14.</span> <span class="toc-text"> Final</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%89%E6%8B%A9"><span class="toc-number">14.1.</span> <span class="toc-text"> 选择</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E8%AE%BA"><span class="toc-number">14.1.1.</span> <span class="toc-text"> 概论</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dbdbmsdbadbs"><span class="toc-number">14.1.1.1.</span> <span class="toc-text"> DB,DBMS,DBA,DBS</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E6%AF%94%E8%BE%83"><span class="toc-number">14.1.1.2.</span> <span class="toc-text"> 与文件系统比较</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E7%AD%94"><span class="toc-number">14.2.</span> <span class="toc-text"> 问答</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E7%89%B9%E7%82%B9"><span class="toc-number">14.2.1.</span> <span class="toc-text"> 数据库系统特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E4%BC%98%E7%82%B9"><span class="toc-number">14.2.2.</span> <span class="toc-text"> 存储过程优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87%E7%9A%84%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD"><span class="toc-number">14.2.3.</span> <span class="toc-text"> 游标的主要功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#orm"><span class="toc-number">14.2.4.</span> <span class="toc-text"> ORM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E6%96%B0%E5%A5%A5%E5%B0%94%E8%89%AF%E6%B3%95%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="toc-number">14.2.5.</span> <span class="toc-text"> 数据库设计（新奥尔良法）基本步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE-2"><span class="toc-number">14.2.6.</span> <span class="toc-text"> 视图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8-2"><span class="toc-number">14.2.7.</span> <span class="toc-text"> 触发器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%A7%E9%A2%98"><span class="toc-number">14.3.</span> <span class="toc-text"> 大题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0-2"><span class="toc-number">14.3.1.</span> <span class="toc-text"> 关系代数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sql"><span class="toc-number">14.3.2.</span> <span class="toc-text"> SQL</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">14.3.2.1.</span> <span class="toc-text"> 相关子查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#dml"><span class="toc-number">14.3.2.2.</span> <span class="toc-text"> DML</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE-3"><span class="toc-number">14.3.2.3.</span> <span class="toc-text"> 视图</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">14.3.3.</span> <span class="toc-text"> 事务管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E9%A9%B1%E5%9B%BE%E6%A3%80%E6%9F%A5%E5%86%B2%E7%AA%81%E5%8F%AF%E4%B8%B2%E8%A1%8C%E6%80%A7"><span class="toc-number">14.3.3.1.</span> <span class="toc-text"> 前驱图检查冲突可串行性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A4%E6%AE%B5%E9%94%81%E5%8D%8F%E8%AE%AE"><span class="toc-number">14.3.3.2.</span> <span class="toc-text"> 两段锁协议</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-number">14.3.4.</span> <span class="toc-text"> 备份与恢复</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#undo"><span class="toc-number">14.3.4.1.</span> <span class="toc-text"> Undo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#redo"><span class="toc-number">14.3.4.2.</span> <span class="toc-text"> Redo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#undoredo"><span class="toc-number">14.3.4.3.</span> <span class="toc-text"> Undo&#x2F;Redo</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E8%8C%83%E5%8C%96%E7%90%86%E8%AE%BA"><span class="toc-number">14.3.5.</span> <span class="toc-text"> 规范化理论</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E9%97%AD%E5%8C%85"><span class="toc-number">14.3.5.1.</span> <span class="toc-text"> 求闭包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E5%80%99%E9%80%89%E9%94%AE"><span class="toc-number">14.3.5.2.</span> <span class="toc-text"> 求候选键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B1%82%E6%9C%80%E5%B0%8F%E4%BE%9D%E8%B5%96%E9%9B%86"><span class="toc-number">14.3.5.3.</span> <span class="toc-text"> 求最小依赖集</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E8%A7%A3%E5%88%B03nf"><span class="toc-number">14.3.5.4.</span> <span class="toc-text"> 分解到3NF</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%9D%E6%8C%81%E4%BE%9D%E8%B5%96%E5%88%86%E8%A7%A3%E6%B3%95"><span class="toc-number">14.3.5.4.1.</span> <span class="toc-text"> 保持依赖分解法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%97%A2%E4%BF%9D%E6%8C%81%E4%BE%9D%E8%B5%96%E5%8F%88%E6%97%A0%E6%8D%9F%E5%88%86%E8%A7%A3"><span class="toc-number">14.3.5.4.2.</span> <span class="toc-text"> 既保持依赖，又无损分解</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E8%A7%A3%E5%88%B0bcnf"><span class="toc-number">14.3.5.5.</span> <span class="toc-text"> 分解到BCNF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%BF%9D%E6%8C%81%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96"><span class="toc-number">14.3.5.6.</span> <span class="toc-text"> 判断是否保持函数依赖</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%97%A0%E6%8D%9F%E8%BF%9E%E6%8E%A5"><span class="toc-number">14.3.5.7.</span> <span class="toc-text"> 判断无损连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-number">14.3.6.</span> <span class="toc-text"> 数据库设计</span></a></li></ol></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.jpg"></div><div class="author-info__name text-center">bubble</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">5</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">6</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">2</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" target="_blank" rel="noopener" href="https://www.cnblogs.com/qiuerOTO">全世界最好的xqjj</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/background.jpg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">bubble's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus">   <a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span><span class="pull-right"></span></div><div id="post-info"><div id="post-title">数据库</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2024-07-24</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/%E5%A4%A7%E4%BA%8C%E4%B8%8B/">大二下</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">18.2k</span><span class="post-meta__separator">|</span><span>阅读时长: 61 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><meta name="referrer" content="no-referrer" />
<h1 id="01-数据管理基本概念"><a class="markdownIt-Anchor" href="#01-数据管理基本概念"></a> 01 数据管理基本概念</h1>
<p><strong>数据&amp;信息</strong></p>
<ul>
<li>数据：无意义。数据+解释=信息</li>
<li>信息：影响动态系统的状态的事件。</li>
</ul>
<h2 id="数据管理"><a class="markdownIt-Anchor" href="#数据管理"></a> 数据管理</h2>
<ul>
<li>数据定义</li>
<li>数据组织、存储、管理</li>
<li>数据操纵</li>
<li>数据库事务管理和运行管理</li>
<li>数据库的建立与维护</li>
</ul>
<h3 id="数据库系统"><a class="markdownIt-Anchor" href="#数据库系统"></a> 数据库系统</h3>
<p>由应用程序、数据库、数据库管理系统和用户组成。</p>
<ul>
<li>数据共享：不同用户使用数据重叠。</li>
<li>数据独立性：数据库中的数据与应用程序之间不存在依赖关系。
<ul>
<li>物理独立性：数据库（从光盘挪到磁盘：物理层修改），程序不影响。</li>
<li>逻辑数据独立性：修改数据库的逻辑模式而不必重写应用程序的能力。</li>
</ul>
</li>
<li>方便的用户接口（SQL）</li>
<li>统一的数据管理与控制功能
<ul>
<li>数据完整性：正确性，有效性和相容性。</li>
<li>数据安全性：主动安全（有效防止数据被非法使用&amp;修改），被动安全（遭到破坏可以完全恢复）</li>
<li>并发控制</li>
</ul>
</li>
</ul>
<h1 id="02-数据模型"><a class="markdownIt-Anchor" href="#02-数据模型"></a> 02 数据模型</h1>
<p>数据模型：是模型的一种，是现实世界数据特征的抽象，是用来描述数据的一组概念和定义。</p>
<h2 id="概念模型"><a class="markdownIt-Anchor" href="#概念模型"></a> 概念模型</h2>
<p>对现实世界的第一层抽象。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221105441.png" alt="" /></p>
<p><strong>概念数据模型</strong></p>
<ul>
<li>是独立于计算机系统的数据模型，不涉及信息在计算机中的表示，只用来描述某个特定组织所关心的信息结构，是对现实世界的第一层抽象。</li>
<li>按用户的观点对数据建模，强调其语义表达能力，是用户和数据库设计人员之间进行交流的语言和工具。</li>
</ul>
<p>要求：强语义表达能力，方便直接的表达应用中的各种语义知识</p>
<h3 id="er数据模型"><a class="markdownIt-Anchor" href="#er数据模型"></a> ER数据模型</h3>
<p><mark>最常用的一种概念数据模型</mark></p>
<h4 id="抽象手段"><a class="markdownIt-Anchor" href="#抽象手段"></a> 抽象手段</h4>
<h5 id="分类"><a class="markdownIt-Anchor" href="#分类"></a> 分类</h5>
<ul>
<li>定义某一类感念作为现实世界中一组对象的类型。</li>
<li>在特定的上下文里，这些对象具有某些共同特性和行为。</li>
<li>大学里的学生，奥运会的赛事，公交公司的司机…</li>
</ul>
<h5 id="聚集"><a class="markdownIt-Anchor" href="#聚集"></a> 聚集</h5>
<ul>
<li>定义某一类型的组成成分</li>
<li>根据上下文管理需求，给出指定类型的特征集合</li>
<li>学生：学号、姓名、年龄等特征组成</li>
</ul>
<h4 id="基本元素"><a class="markdownIt-Anchor" href="#基本元素"></a> 基本元素</h4>
<ul>
<li>实体：客观存在并可以相互区分的客观事物或抽象事件。<mark>分类</mark>
<ul>
<li>实体集：同型实体的集合。</li>
</ul>
</li>
<li>属性：实体所具有的某一特性。<mark>聚集</mark>
<ul>
<li>域：是一组具有相同数据类型的值的集合</li>
<li>类型：
<ul>
<li>简单属性：不可再分。eg：学号。</li>
<li>复合属性：可以划分更小的属性。eg：街道=家庭住址+门牌号码。</li>
<li>单值属性：每一个特定的实体在该属性上的取值唯一。</li>
<li>多值属性：特定实体在该属性上有多于一个的取值（eg：电话）</li>
</ul>
</li>
<li>键（key）：
<ul>
<li>实体集中能唯一标识实体的属性或属性组称为实体集的键.</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">&gt;2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>是复合键。</li>
</ul>
</li>
</ul>
</li>
<li>联系：笛卡尔积。</li>
</ul>
<h4 id="er图"><a class="markdownIt-Anchor" href="#er图"></a> ER图</h4>
<p>🍰 实体：矩形框</p>
<p>🍰 属性：椭圆框并用连线连到相应实体。</p>
<p>🍰 联系：菱形框并用连线与有关的实体相连。</p>
<p>联系的元：参与联系的实体的个数。</p>
<p>联系的基数比约束：1：1，1：n，m：n（谁是1那边谁标1：领导1工人n）</p>
<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221105960.png" alt="" style="zoom:80%;" />
<p><font color='purple'><strong>多元联系中使用箭头——知道了其他几种就可以确定箭头指向的信息：</strong></font></p>
<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406232236040.png" alt="" style="zoom:50%;" />
<h4 id="约束"><a class="markdownIt-Anchor" href="#约束"></a> 约束</h4>
<p>约束：数据库的断言（对插入数据库中的数据进行限定）</p>
<blockquote>
<p>非空约束，唯一值约束，主键约束，外键约束，Check约束</p>
</blockquote>
<h5 id="键约束"><a class="markdownIt-Anchor" href="#键约束"></a> 键约束</h5>
<p>超键：是实体集中的一个或一组属性，可以唯一的确定每一个实体。</p>
<p>候选键：某个超键的最小集。</p>
<p>存在多个候选键，可以任选一个作为主键。</p>
<h4 id="建模准则"><a class="markdownIt-Anchor" href="#建模准则"></a> 建模准则</h4>
<p><mark>能抽象为属性的，就不要抽象为实体</mark>。符合以下之一才被抽象为实体：</p>
<ul>
<li>至少一个非键属性。</li>
<li>处于“一对多”或“多对多”联系中“多”那一端。</li>
</ul>
<h2 id="逻辑模型"><a class="markdownIt-Anchor" href="#逻辑模型"></a> 逻辑模型</h2>
<p>对现实世界的第二层抽象，与DBMS有关。</p>
<ul>
<li>直接面向数据库的逻辑结构,是对现实世界的第二层抽象。它直接与DBMS有关,有严格的形式化定义,以便在计算机系统中实现。</li>
<li>有一组严格定义的无二义性语法和语义的DB语言</li>
<li>层次模型、网状模型、关系模型等</li>
<li><mark>是区分不同类型数据库的依据，很大程度上决定了数据库的性能和应用范围</mark></li>
</ul>
<p>通常所说的数据模型就是逻辑数据模型</p>
<p>三要素：数据结构，数据操作和数据约束。</p>
<h2 id="物理模型"><a class="markdownIt-Anchor" href="#物理模型"></a> 物理模型</h2>
<ul>
<li>反映了数据在存储介质上的组成结构，并描述了访问机制</li>
<li>如何表达记录结构、记录顺序和访问路径等信息</li>
</ul>
<h1 id="03-关系模型"><a class="markdownIt-Anchor" href="#03-关系模型"></a> 03 关系模型</h1>
<p>逻辑数据结构三要素：<strong>数据结构、数据操作和数据约束</strong>。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221105662.png" alt="" /></p>
<p>关系模型：二维表格结构表示实体及实体之间的联系的模型。<strong>对关系的数学理论描述</strong></p>
<p>关系模式：<strong>对关系的结构描述</strong></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241044256.jpeg" alt="watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETkDliqrlipvlpYvmlpfnmoTlvKDlkIzlraY,size_20,color_FFFFFF,t_70,g_se,x_16" /></p>
<h2 id="关系数据结构"><a class="markdownIt-Anchor" href="#关系数据结构"></a> 关系数据结构</h2>
<p>关系与关系间有公共属性，说明两个关系有联系。</p>
<p>只要把的所有的实体及其属性用关系框架来表示，同时把实体之间的关系也用关系框架来表示，就可以得到一个关系模型。</p>
<h3 id="性质"><a class="markdownIt-Anchor" href="#性质"></a> 性质</h3>
<ul>
<li>
<p>不能出现相同元组（笛卡尔积每一个元素叫做一个n元组，即关系表的一行）</p>
</li>
<li>
<p>关系中元组的顺序（即行序）无关紧要。</p>
</li>
<li>
<p>属性的顺序也无关紧要，应连同属性名一起交换。</p>
</li>
<li>
<p>统一属性名下的个属性必须来自同一个域，是同一类型的数据。</p>
</li>
<li>
<p>关系中各个属性必须有不同的名字，不同的属性可来自同一个域，即它们的分量可以取自同一个域。（eg：职业&amp;兼职）</p>
</li>
<li>
<p>每一分量必须是不可分的数据项。所有属性值都是原子的，是一个确定的值，而不是值的集合。不可“表中有表”。满足此条件的关系称为<font color='Fswf'>规范化关系</font>，否则称为<font color='Fswf'>非规范化关系</font>。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221105268.png" alt="" /></p>
</li>
</ul>
<h3 id="er模型向关系模型转化"><a class="markdownIt-Anchor" href="#er模型向关系模型转化"></a> ER模型向关系模型转化</h3>
<h4 id="实体类型转换"><a class="markdownIt-Anchor" href="#实体类型转换"></a> 实体类型转换</h4>
<p>每个实体类型转换成一个关系模式，实体的属性即为关系模式的属性，实体标识符即为关系模式的键。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221105883.png" alt="" /></p>
<h4 id="二元联系类型的转换"><a class="markdownIt-Anchor" href="#二元联系类型的转换"></a> 二元联系类型的转换</h4>
<ul>
<li>
<p>m：n</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106369.png" alt="" /></p>
</li>
<li>
<p>1：n：直接合并。将1合并到n端。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106308.png" alt="" /></p>
</li>
</ul>
<h2 id="关系的完整性"><a class="markdownIt-Anchor" href="#关系的完整性"></a> 关系的完整性</h2>
<ul>
<li>域完整性
<ul>
<li>属性值应符合域的取值范围，增强数据类型</li>
<li><mark>对是否为NULL也是域完整性约束的一部分</mark></li>
</ul>
</li>
<li>实体完整性
<ul>
<li>主键（非空，取值唯一）</li>
</ul>
</li>
<li>参照完整性
<ul>
<li>外键：关系与关系之间的引用（空值|等于被参照关系中某个元组的主键值）</li>
</ul>
</li>
<li>用户定义的完整性：对某一具体关系数据库的约束条件。</li>
</ul>
<h2 id="关系代数"><a class="markdownIt-Anchor" href="#关系代数"></a> 关系代数</h2>
<p><mark>查询的条件要使用关系运算表达式来表示</mark></p>
<ul>
<li>运算对象：关系。</li>
<li>运算结果：关系。</li>
<li>运算符：四类。</li>
</ul>
<p><font color='red'>基本运算：集合并、集合差、广义笛卡儿积、选择、投影</font></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106540.png" alt="" /></p>
<h3 id="集合运算符"><a class="markdownIt-Anchor" href="#集合运算符"></a> 集合运算符</h3>
<p><mark>行的角度</mark></p>
<p>并交差运算：必须是相容的：</p>
<ul>
<li>关系R和S同元，属性数目必须相同。</li>
<li>对于所有i，R的第i格属性的域必须和S的第i个属性的域相同。</li>
</ul>
<p>广义笛卡尔积：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106403.png" alt="" /></p>
<p>交运算：</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∩</mo><mi>S</mi><mo>=</mo><mi>R</mi><mo>−</mo><mo stretchy="false">(</mo><mi>R</mi><mo>−</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R\cap S=R-(R-S)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span></span></span></span></p>
<h3 id="专门的关系运算符"><a class="markdownIt-Anchor" href="#专门的关系运算符"></a> 专门的关系运算符</h3>
<p><mark>行和列的方向同时选择</mark></p>
<p><strong>选择</strong>：选择某些元组形成一个新的关系。（选择符合条件的行/元组）</p>
<p>\sigma_{F}(R)=\{t|t\in R \and F(t)=true \}。R是关系名，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>是选择运算符，F是逻辑表达式。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106391.png" alt="" /></p>
<p><strong>投影</strong>：选择指定的属性，形成一个可能含有重复行的表格，删除重复行形成新关系。（投影可改变关系的属性次序，新关系与原关系不相容）</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>π</mi><mi>A</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">{</mo><mi>r</mi><mi mathvariant="normal">.</mi><mi>A</mi><mi mathvariant="normal">∣</mi><mi>r</mi><mo>∈</mo><mi>R</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\pi_A(R)=\{r.A|r\in R\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord">.</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">}</span></span></span></span>，R是关系名，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">π</span></span></span></span>是投影运算符，A是被投影的属性或属性集</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106240.png" alt="" /></p>
<p><strong>连接</strong>：两个表之间的运算，一对多联系的父子关系。一般是由参照关系的外键和被参照关系的主键控制。</p>
R \underset{A\theta B}\bowtie S=\{t|t=<r,s>\and r\in R\and s\in S\and r[A]\ \theta\ s[B]\}

<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106746.png" alt="" /></p>
<ul>
<li>
<p>自然连接：从两个关系的广义笛卡儿积中选取在相同属性列上取值相等的元组，并去掉重复的属性列。特殊的等值连接。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106781.png" alt="" /></p>
</li>
<li>
<p>外连接：自然连接 + 失配的元组。<img src="../../Sophomore/%E6%88%AA%E5%9B%BE/.png" alt="" /><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221106453.png" alt="" /></p>
</li>
<li>
<p>自连接：两张一模一样的表连接。</p>
</li>
</ul>
<p><strong>除</strong>：至少。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>÷</mo><mi>S</mi><mo>=</mo><msub><mi>π</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>π</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>π</mi><mi>x</mi></msub><mo stretchy="false">(</mo><mi>R</mi><mo stretchy="false">)</mo><mo>×</mo><mi>S</mi><mo stretchy="false">)</mo><mo>−</mo><mi>R</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R \div S=\pi_{x}(R)-\pi_{x}((\pi_{x}(R)\times S)-R)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">π</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mclose">)</span></span></span></span>.</p>
<p><mark>即所有满足被除项的判断，排除不在被除项的属性</mark></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406222030556.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406222031235.png" alt="" /></p>
<h1 id="04-sql语言"><a class="markdownIt-Anchor" href="#04-sql语言"></a> 04 SQL语言</h1>
<h2 id="查询语言"><a class="markdownIt-Anchor" href="#查询语言"></a> 查询语言</h2>
<h3 id="单表查询"><a class="markdownIt-Anchor" href="#单表查询"></a> 单表查询</h3>
<h4 id="选择列"><a class="markdownIt-Anchor" href="#选择列"></a> 选择列</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sno,Sname <span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>
<h4 id="查询经计算的值"><a class="markdownIt-Anchor" href="#查询经计算的值"></a> 查询经计算的值</h4>
<ul>
<li>
<p><code>LOWER(Sdept)</code>：将所有字母小写。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname,<span class="number">2022</span><span class="operator">-</span>Sage,<span class="built_in">LOWER</span>(Sdept) <span class="keyword">FROM</span> Student;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>使用列别名改变查询结果的列标题：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname <span class="keyword">AS</span> NAME，<span class="string">&#x27;Year of Birth: &#x27;</span> <span class="keyword">AS</span> BIRTH，</span><br><span class="line"><span class="number">2022</span><span class="operator">-</span>Sage <span class="keyword">AS</span> BIRTHDAY，<span class="built_in">LOWER</span>(Sdept) <span class="keyword">AS</span> DEPARTMENT <span class="keyword">FROM</span> Student；</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="选择元组"><a class="markdownIt-Anchor" href="#选择元组"></a> 选择元组</h4>
<ul>
<li>
<p>保留重复行（ALL，可省略）。消除取值重复的行（DISTINCT）<mark>DISTINCT短语的作用范围是所有目标列，放在属性的最前面！！！</mark></p>
</li>
<li>
<p>查询满足条件的元组：where。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> Sdept <span class="keyword">IN</span>(<span class="string">&#x27;IS&#x27;</span>,<span class="string">&#x27;MA&#x27;</span>,<span class="string">&#x27;CS&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406071518311.png" alt="" /></p>
<ul>
<li>
<p><code>between ... and ...</code>（<strong>包括边界</strong>）：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sanme <span class="keyword">from</span> student <span class="keyword">where</span> sage <span class="keyword">between</span> <span class="number">20</span> <span class="keyword">and</span> <span class="number">23</span>;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>字符串匹配：</p>
<p>%任意长度（可以为0）的字符串，_单个字符。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> <span class="operator">&lt;</span>Attribute<span class="operator">&gt;</span> <span class="keyword">LIKE</span> <span class="operator">&lt;</span><span class="keyword">pattern</span><span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>
<p>查询中本身含有%or_，使用ESCAPE。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WHERE</span> Cname <span class="keyword">LIKE</span> <span class="string">&#x27;DB\_Design&#x27;</span> <span class="keyword">ESCAPE</span> ‘\<span class="string">&#x27;;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>涉及空值的查询（任意与NULL比较结果都为Unknown）</p>
<p>三值逻辑计算：TRUE = 1, FALSE = 0, and UNKNOWN = ½。AND = MIN; OR = MAX, NOT(<em>x</em>) = 1-<em>x</em>、</p>
<p><code>IS NULL</code>：是空值。</p>
</li>
</ul>
<h4 id="排序"><a class="markdownIt-Anchor" href="#排序"></a> 排序</h4>
<p>ASC：升序。空值最后显示。</p>
<p>DESC：降序。空值最先显示。</p>
<h3 id="聚集和分组"><a class="markdownIt-Anchor" href="#聚集和分组"></a> 聚集和分组</h3>
<h4 id="聚集-2"><a class="markdownIt-Anchor" href="#聚集-2"></a> 聚集</h4>
<p>空值不加入计算。</p>
<ul>
<li>
<p>计数 COUNT（[DISTINCT|ALL] &lt;列名&gt; | *）</p>
</li>
<li>
<p>计算总和 SUM （[DISTINCT|ALL] &lt;列名&gt;）</p>
</li>
<li>
<p>计算平均值 AVG（[DISTINCT|ALL] &lt;列名&gt;）</p>
</li>
<li>
<p>求最大值 MAX（[DISTINCT|ALL] &lt;列名&gt;）</p>
</li>
<li>
<p>求最小值 MIN（[DISTINCT|ALL] &lt;列名&gt;）</p>
</li>
</ul>
<h4 id="group-by"><a class="markdownIt-Anchor" href="#group-by"></a> GROUP BY</h4>
<p>对每一个组进行集操作。</p>
<h4 id="having"><a class="markdownIt-Anchor" href="#having"></a> Having</h4>
<p><mark>只有满足HAVING短语指定条件的组才输出</mark></p>
<p>HAVING短语与WHERE子句的区别：作用对象不同。</p>
<ul>
<li>WHERE子句作用于基表或视图，从中选择满足条件的元组。<mark>不能使用集函数</mark></li>
<li>HAVING短语作用于组，从中选择满足条件的组。<mark>可以使用集函数</mark></li>
</ul>
<p>HAVING子句中出现的列只能是在group by子句或集函数中出现的列。</p>
<h3 id="多表查询"><a class="markdownIt-Anchor" href="#多表查询"></a> 多表查询</h3>
<h4 id="连接查询"><a class="markdownIt-Anchor" href="#连接查询"></a> 连接查询</h4>
<h5 id="笛卡尔积"><a class="markdownIt-Anchor" href="#笛卡尔积"></a> 笛卡尔积</h5>
<p>也可以不带连接谓词。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Student.<span class="operator">*</span>,SC.<span class="operator">*</span> <span class="keyword">FROM</span> Student <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> SC;</span><br></pre></td></tr></table></figure>
<h5 id="等值连接"><a class="markdownIt-Anchor" href="#等值连接"></a> 等值连接</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Student.sno,sname,cno <span class="keyword">FROM</span> Student ,SC <span class="keyword">WHERE</span> Student.Sno<span class="operator">=</span>SC.Sno;</span><br></pre></td></tr></table></figure>
<p>自然连接：等值连接特殊情况。把目标列中重复的属性列去掉。</p>
<p>自连接：一个表与自己连接。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> FIRST.Cno，SECOND.Cpno <span class="keyword">FROM</span> Course <span class="keyword">AS</span> <span class="keyword">FIRST</span>，Course <span class="keyword">AS</span> <span class="keyword">SECOND</span> <span class="keyword">WHERE</span> FIRST.Cpno <span class="operator">=</span> SECOND.Cno；</span><br></pre></td></tr></table></figure>
<h3 id="子查询"><a class="markdownIt-Anchor" href="#子查询"></a> 子查询</h3>
<p>在FROM中嵌套查询语句，但不能order！</p>
<p><strong>子查询中不能使用order by</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Sname <span class="keyword">FROM</span> Student <span class="keyword">WHERE</span> Sno <span class="keyword">IN</span>(SELECTSno <span class="keyword">FROM</span> SC <span class="keyword">WHERE</span> Cno<span class="operator">=</span><span class="string">&#x27;2&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h4 id="带in谓词的子查询"><a class="markdownIt-Anchor" href="#带in谓词的子查询"></a> 带IN谓词的子查询</h4>
<p>查询与刘晨在同一个系学习的学生：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sno,sname,sdept <span class="keyword">from</span> student <span class="keyword">where</span> sdept <span class="keyword">in</span> (<span class="keyword">select</span> sdept <span class="keyword">from</span> student <span class="keyword">where</span> sname<span class="operator">=</span><span class="string">&#x27;刘晨&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>如果能确切知道内层查询返回单值时，可使用比较运算符，比如上面句子可把IN改为=。</p>
<p><strong><mark>子查询一定跟在比较符后面</mark></strong></p>
<h4 id="带有any或all谓词的子查询"><a class="markdownIt-Anchor" href="#带有any或all谓词的子查询"></a> 带有ANY或ALL谓词的子查询</h4>
<ul>
<li>ANY：任意一个值</li>
<li>ALL：所有值</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406222316337.png" alt="" /></p>
<p>查询其他系中比信息系任意一个（其中某一个）学生年龄小的学生姓名和年龄：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,sage <span class="keyword">from</span> student <span class="keyword">where</span> sage<span class="operator">&lt;</span><span class="keyword">any</span>(<span class="keyword">select</span> sage <span class="keyword">from</span> student <span class="keyword">where</span> sdept<span class="operator">=</span><span class="string">&#x27;IS&#x27;</span>) <span class="keyword">and</span> sdept<span class="operator">!=</span><span class="string">&#x27;IS&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p><strong>用集函数实现子查询通常比直接用ANY或ALL查询效率要高</strong>：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406222320867.png" alt="" /></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,sage <span class="keyword">from</span> student <span class="keyword">where</span> sage<span class="operator">&lt;</span>(<span class="keyword">select</span> <span class="built_in">max</span>(sage) <span class="keyword">from</span> student <span class="keyword">where</span> sdept<span class="operator">=</span><span class="string">&#x27;IS&#x27;</span>)<span class="keyword">and</span> sdept<span class="operator">!=</span><span class="string">&#x27;IS&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h4 id="带有exists谓词的子查询"><a class="markdownIt-Anchor" href="#带有exists谓词的子查询"></a> 带有EXISTS谓词的子查询</h4>
<p>查询所有选修了1号课程的学生姓名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sc <span class="keyword">where</span> sno<span class="operator">=</span>student.sno <span class="keyword">and</span> cno<span class="operator">=</span><span class="string">&#x27;1&#x27;</span>);</span><br></pre></td></tr></table></figure>
<h3 id="集合查询"><a class="markdownIt-Anchor" href="#集合查询"></a> 集合查询</h3>
<p>并：UNION。交：INTERSECT。差：EXCEPT。</p>
<h2 id="ddl语言"><a class="markdownIt-Anchor" href="#ddl语言"></a> DDL语言</h2>
<h3 id="基本表"><a class="markdownIt-Anchor" href="#基本表"></a> 基本表</h3>
<h4 id="定义表"><a class="markdownIt-Anchor" href="#定义表"></a> 定义表</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span>(</span><br><span class="line">	<span class="operator">&lt;</span>列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>[<span class="operator">&lt;</span>列级完整性约束条件<span class="operator">&gt;</span>],</span><br><span class="line">	....</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>列级完整性约束条件：</p>
<ul>
<li><code>not null</code>：非空。</li>
<li><code>unique</code>：取值唯一。</li>
<li><code>primary key</code>：主键约束。</li>
<li><code>references</code>：参照完整性约束。</li>
</ul>
<p>数据类型：</p>
<ul>
<li><code>char(4)</code>：定长字符串。</li>
<li><code>varchar(n)</code>：变长字符串，n为字符串最大长度。</li>
</ul>
<h4 id="删除表"><a class="markdownIt-Anchor" href="#删除表"></a> 删除表</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> student;</span><br></pre></td></tr></table></figure>
<h4 id="修改表"><a class="markdownIt-Anchor" href="#修改表"></a> 修改表</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span></span><br><span class="line">[<span class="keyword">add</span> <span class="operator">&lt;</span>新列名<span class="operator">&gt;</span> <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span> [完整性约束]]</span><br><span class="line">[<span class="keyword">drop</span> <span class="operator">&lt;</span>完整性约束名<span class="operator">&gt;</span>]</span><br><span class="line">[modify <span class="operator">&lt;</span>列名<span class="operator">&gt;</span>  <span class="operator">&lt;</span>数据类型<span class="operator">&gt;</span>]</span><br></pre></td></tr></table></figure>
<p>add：增加心列和新的完整性约束条件。</p>
<p>drop：删除指定的列或完整性约束条件。</p>
<p>modify：修改列名和数据类型。</p>
<h2 id="dml语言"><a class="markdownIt-Anchor" href="#dml语言"></a> DML语言</h2>
<h3 id="插入"><a class="markdownIt-Anchor" href="#插入"></a> 插入</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span> [(key1,key2...)] <span class="keyword">values</span> (value1,value2...);</span><br></pre></td></tr></table></figure>
<p>没提到的属性取空值。</p>
<p>插入子查询的结果：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> deptage(sdept,avgage) <span class="keyword">values</span></span><br><span class="line"><span class="keyword">select</span> sdept,<span class="built_in">avg</span>(sage)</span><br><span class="line"><span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span> sdept;</span><br></pre></td></tr></table></figure>
<h3 id="更新"><a class="markdownIt-Anchor" href="#更新"></a> 更新</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span> <span class="keyword">set</span> key1<span class="operator">=</span>value1,key2<span class="operator">=</span>value2...where <span class="operator">&lt;</span>conditions<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>
<p>计算机系全体学生成绩清零（子查询）：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> sc <span class="keyword">set</span> grade<span class="operator">=</span><span class="number">0</span></span><br><span class="line"><span class="keyword">where</span> <span class="string">&#x27;cs&#x27;</span><span class="operator">=</span></span><br><span class="line">(<span class="keyword">select</span> sdept <span class="keyword">from</span> student <span class="keyword">where</span> student.sno<span class="operator">=</span>sc.sno);</span><br></pre></td></tr></table></figure>
<h3 id="删除"><a class="markdownIt-Anchor" href="#删除"></a> 删除</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="operator">&lt;</span>table_name<span class="operator">&gt;</span> <span class="keyword">where</span> <span class="operator">&lt;</span>conditions<span class="operator">&gt;</span>;</span><br></pre></td></tr></table></figure>
<h2 id="dcl语言"><a class="markdownIt-Anchor" href="#dcl语言"></a> DCL语言</h2>
<h2 id="视图"><a class="markdownIt-Anchor" href="#视图"></a> 视图</h2>
<p>一种虚表，从一个或几个基本表/视图中导出的表，在数据字典中存储的是一条select语句。</p>
<p><strong>带表达式的视图必须明确定义组成视图的各个属性列名</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> is_student[列名<span class="number">1</span>，列名<span class="number">2.</span>.]</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> sno,sname,sage</span><br><span class="line"><span class="keyword">from</span> student</span><br><span class="line"><span class="keyword">where</span> sdept<span class="operator">=</span><span class="string">&#x27;is&#x27;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>DBMS在执行create view语句时只是把视图的定义存入数据字典，并没有执行select</p>
</blockquote>
<p>对于可更新视图，可以对视图执行数据更新操作，数据库会根据视图定义去更新对应的基本表数据</p>
<p>不建议以<code>select *</code>方式创建视图，可延展性差（基表被破坏后，视图不能正常工作）</p>
<h1 id="05-数据库编程"><a class="markdownIt-Anchor" href="#05-数据库编程"></a> 05 数据库编程</h1>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406071522709.png" alt="" /></p>
<ul>
<li>数据库内部应用：效率高，适用于例行的数据分析维护功能</li>
<li>数据库外部应用：开发灵活，功能与可移植性更强</li>
</ul>
<h2 id="数据库内部编程"><a class="markdownIt-Anchor" href="#数据库内部编程"></a> 数据库内部编程</h2>
<h3 id="存储过程"><a class="markdownIt-Anchor" href="#存储过程"></a> 存储过程</h3>
<p>多次重复使用的代码编写成过程。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> <span class="operator">&lt;</span>procedure_name<span class="operator">&gt;</span>(</span><br><span class="line">	[<span class="keyword">in</span><span class="operator">/</span><span class="keyword">out</span><span class="operator">/</span><span class="keyword">inout</span>]param_name type[,...]</span><br><span class="line">)</span><br><span class="line">[<span class="keyword">begin</span>]</span><br><span class="line">	sql_statement</span><br><span class="line">[<span class="keyword">end</span>]</span><br></pre></td></tr></table></figure>
<p><code>in</code>输入参数，<code>out</code>输出参数，<code>inout</code>输入输出参数，既表示调用者向过程传入值，又表示过程向调用者传出值。</p>
<blockquote>
<p>eg:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">procedure</span> mypro(<span class="keyword">in</span> a <span class="type">int</span>,<span class="keyword">in</span> b <span class="type">int</span>,<span class="keyword">out</span> sum <span class="type">int</span>) </span><br><span class="line"><span class="keyword">begin</span> </span><br><span class="line"><span class="keyword">set</span> sum <span class="operator">=</span> a<span class="operator">+</span>b; </span><br><span class="line"><span class="keyword">end</span>;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>删除：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">procedure</span> procedure_name</span><br></pre></td></tr></table></figure>
<p>激活存储过程的执行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">call</span> procedure_name(param_name type[,...])</span><br></pre></td></tr></table></figure>
<h4 id="变量"><a class="markdownIt-Anchor" href="#变量"></a> 变量</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> variable_name [,variable_name...] datatype [<span class="keyword">DEFAULT</span> <span class="keyword">value</span>];</span><br></pre></td></tr></table></figure>
<p><code>datatype</code>MYSQL的数据类型，<code>default</code>声明默认值。</p>
<p>eg：<code>declare name varchar(20) default ‘jack’</code></p>
<p>变量赋值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> 变量名 <span class="operator">=</span> 表达式值 [,variable_name <span class="operator">=</span> expression ...]</span><br></pre></td></tr></table></figure>
<h4 id="流程控制"><a class="markdownIt-Anchor" href="#流程控制"></a> 流程控制</h4>
<h5 id="if"><a class="markdownIt-Anchor" href="#if"></a> if</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">if num<span class="operator">&lt;</span><span class="number">0</span> <span class="keyword">then</span> <span class="comment">-- 条件开始</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;负数&#x27;</span>;</span><br><span class="line">elseif num<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;不是正数也不是负数&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">select</span> <span class="string">&#x27;正数&#x27;</span>;</span><br><span class="line"><span class="keyword">end</span> if;<span class="comment">-- 条件结束</span></span><br></pre></td></tr></table></figure>
<h5 id="case"><a class="markdownIt-Anchor" href="#case"></a> case</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="comment">-- 条件开始</span></span><br><span class="line"><span class="keyword">when</span> num<span class="operator">&lt;</span><span class="number">0</span> <span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;负数&#x27;</span>;</span><br><span class="line"><span class="keyword">when</span> num<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="keyword">select</span> <span class="string">&#x27;不是正数也不是负数&#x27;</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">select</span> <span class="string">&#x27;正数&#x27;</span>;</span><br><span class="line"><span class="keyword">end</span> <span class="keyword">case</span>; <span class="comment">-- 条件结束</span></span><br></pre></td></tr></table></figure>
<h5 id="while"><a class="markdownIt-Anchor" href="#while"></a> while</h5>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">while num<span class="operator">&lt;</span><span class="number">10</span> do <span class="comment">-- 循环开始</span></span><br><span class="line"><span class="keyword">set</span> num <span class="operator">=</span> num<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> sum <span class="operator">=</span> sum<span class="operator">+</span>num;</span><br><span class="line"><span class="keyword">end</span> while; <span class="comment">-- 循环结束</span></span><br></pre></td></tr></table></figure>
<h5 id="repeat"><a class="markdownIt-Anchor" href="#repeat"></a> repeat</h5>
<p>类似<code>do...while</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">repeat<span class="comment">-- 循环开始</span></span><br><span class="line"><span class="keyword">set</span> num <span class="operator">=</span> num<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> sum <span class="operator">=</span> sum<span class="operator">+</span>num;</span><br><span class="line">until num<span class="operator">&gt;=</span><span class="number">10</span></span><br><span class="line"><span class="keyword">end</span> repeat;</span><br></pre></td></tr></table></figure>
<h5 id="loop"><a class="markdownIt-Anchor" href="#loop"></a> loop</h5>
<p><code>leave</code>相当于break，<code>iterate</code>相当于continue</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">loop_sum:loop<span class="comment">-- 循环开始</span></span><br><span class="line"><span class="keyword">set</span> num <span class="operator">=</span> num<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">set</span> sum <span class="operator">=</span> sum<span class="operator">+</span>num;</span><br><span class="line">if num<span class="operator">&gt;=</span><span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">leave loop_sum;</span><br><span class="line"><span class="keyword">end</span> if;</span><br><span class="line"><span class="keyword">end</span> loop loop_sum;</span><br></pre></td></tr></table></figure>
<h4 id="常用数据库函数与命令"><a class="markdownIt-Anchor" href="#常用数据库函数与命令"></a> 常用数据库函数与命令</h4>
<p>显示存储过程：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PROCEDURE</span> STATUS;</span><br></pre></td></tr></table></figure>
<p>显示特定数据库的存储过程</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PROCEDURE</span> status <span class="keyword">where</span> db <span class="operator">=</span> <span class="string">&#x27;schooldb&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>显示特定模式的存储过程，要求显示名称中包含“my”的存储过程：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">PROCEDURE</span> status <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%my%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>显示存储过程“mypro1”的源码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> mypro1;</span><br></pre></td></tr></table></figure>
<h4 id="嵌入式sql"><a class="markdownIt-Anchor" href="#嵌入式sql"></a> 嵌入式SQL</h4>
<p>赋值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">declare</span> v_score <span class="type">int</span>;</span><br><span class="line"><span class="keyword">select</span> score <span class="keyword">into</span> v_score <span class="keyword">from</span> sc <span class="keyword">where</span> cno<span class="operator">=</span><span class="number">55</span> <span class="keyword">and</span> stuid<span class="operator">=</span><span class="number">001</span>;</span><br></pre></td></tr></table></figure>
<p>set值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> v_score<span class="operator">=</span>v_score<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">update</span> sc <span class="keyword">set</span> score<span class="operator">=</span>v_score <span class="keyword">where</span> cno<span class="operator">=</span><span class="number">55</span> <span class="keyword">and</span> stuid<span class="operator">=</span><span class="number">001</span>;</span><br></pre></td></tr></table></figure>
<h4 id="动态sql"><a class="markdownIt-Anchor" href="#动态sql"></a> 动态SQL</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> count_field(<span class="keyword">IN</span> FIELDNAME <span class="type">VARCHAR</span>(<span class="number">255</span>), <span class="keyword">IN</span> </span><br><span class="line">FIELDVALUE <span class="type">INT</span>) </span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@sql</span> <span class="operator">=</span> CONCAT(<span class="string">&#x27;SELECT COUNT(*) FROM stu WHERE ‘, </span></span><br><span class="line"><span class="string">FIELDNAME, &#x27;</span> <span class="operator">=</span> ?’); </span><br><span class="line"><span class="keyword">PREPARE</span> stmt <span class="keyword">FROM</span> <span class="variable">@sql</span>; </span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@fieldvalue</span> <span class="operator">=</span> FIELDVALUE; </span><br><span class="line"><span class="keyword">EXECUTE</span> stmt <span class="keyword">USING</span> <span class="variable">@fieldvalue</span>; </span><br><span class="line"><span class="keyword">DEALLOCATE</span> <span class="keyword">PREPARE</span> stmt; </span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>
<h4 id="游标编程"><a class="markdownIt-Anchor" href="#游标编程"></a> 游标编程</h4>
<p>对查询语句返回的行结果集中的每一行进行单独处理。</p>
<p>主要功能：</p>
<ul>
<li>定位到结果集中的指定行</li>
<li>从结果集的当前位置检索一行或多行</li>
<li>可对结果集中当前位置的行进行数据修改</li>
<li>可以显示其他用户对结果集中的数据库函数进行的数据修改</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241205236.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241207438.png" alt="" /></p>
<h3 id="函数"><a class="markdownIt-Anchor" href="#函数"></a> 函数</h3>
<h3 id="触发器"><a class="markdownIt-Anchor" href="#触发器"></a> 触发器</h3>
<p><mark>特殊的存储过程，实现复杂逻辑的用户自定义约束的工具</mark></p>
<ul>
<li>与表|视图|数据库紧密相连，不能脱离宿主存在</li>
<li>由数据库自动调用执行，用户不能调用</li>
<li>没有参数和返回值</li>
</ul>
<p>Event（引起数据库更新的事件）—Condition（是否满足条件）—Action（任意的SQL）</p>
<p><strong>创建：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">trigger</span> trigger_name BEFORE<span class="operator">|</span>AFTER<span class="operator">|</span>INSTEAD <span class="keyword">OF</span> trigger_EVENT <span class="keyword">ON</span> TABLE_NAME <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span> trigger_STMT </span><br></pre></td></tr></table></figure>
<ul>
<li>事件
<ul>
<li>表|视图级事件：<code>insert/delete/update</code></li>
<li>数据库级事件：<code>create/alter/drop table/procedure/view</code></li>
</ul>
</li>
<li>触发时机：<code>after/before/instead of</code>（直接转到触发器动作，而不执行之前的<code>insert</code>，<code>update</code>等操作，<u><strong>可以实现不可更新视图的更新</strong>）</u></li>
<li>触发/执行粒度：
<ul>
<li>语句级触发器：缺省，每条用户语句触发一次</li>
<li>行级触发器<code>for each row</code>：每条受影响的记录，触发一次触发器</li>
</ul>
</li>
<li><code>referecing</code>引用：包含操作的行<code>new.attribute</code>，<code>old.attribute</code></li>
<li>动作：多于一条语句<code>begin...end</code></li>
</ul>
<p>用触发器实现级联触发：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">trigger</span> fruitTrig after <span class="keyword">insert</span> <span class="keyword">on</span> sells <span class="keyword">referencing</span> <span class="keyword">new</span> <span class="type">row</span> <span class="keyword">as</span> newTuple <span class="keyword">for</span> <span class="keyword">each</span> <span class="type">row</span> <span class="keyword">when</span>(newTuple.fname <span class="keyword">not</span> <span class="keyword">in</span> (<span class="keyword">select</span> fname <span class="keyword">from</span> fruits)) <span class="keyword">insert</span> <span class="keyword">into</span> fruits(fname) <span class="keyword">values</span>(newTuple.fname);</span><br></pre></td></tr></table></figure>
<p><code>newTuple</code>就是新增加的那一行</p>
<h1 id="06-存储与索引"><a class="markdownIt-Anchor" href="#06-存储与索引"></a> 06 存储与索引</h1>
<h2 id="存储"><a class="markdownIt-Anchor" href="#存储"></a> 存储</h2>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101018009.png" alt="" /></p>
<h3 id="逻辑组织结构"><a class="markdownIt-Anchor" href="#逻辑组织结构"></a> 逻辑组织结构</h3>
<ul>
<li>块：一个磁盘页面，I/O一次读写一整个块。</li>
<li>区：磁盘上连续的块集合。</li>
<li>段：一个或多个盘区组成，只存储一类数据对象（表段，索引段，回滚段）<mark>一个表对应一个段</mark></li>
<li>表空间：<mark>数据对象的逻辑结构和物理结构统一</mark>
<ul>
<li>逻辑上由0~n个段组成，物理上1~n个数据文件组成。段不能跨越表空间，但可跨越空间内文件。</li>
<li>表空间——数据文件：一对多</li>
</ul>
</li>
<li>数据库：包含1~n个表空间（用户表空间，临时表空间…）</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101029170.png" alt="" /></p>
<h3 id="物理页面组织结构"><a class="markdownIt-Anchor" href="#物理页面组织结构"></a> 物理页面组织结构</h3>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101035859.png" alt="" /></p>
<h2 id="索引"><a class="markdownIt-Anchor" href="#索引"></a> 索引</h2>
<p>单级索引（二分表查找）：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><msub><mi>g</mi><mn>2</mn></msub><mi>n</mi></mrow><annotation encoding="application/x-tex">log_2n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">n</span></span></span></span>，数量庞大时效率低</p>
<p>多级索引：B+树索引</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101048296.png" alt="" /></p>
<p>如果数据量过大，树会很长，频繁磁盘I/O效率低。</p>
<ul>
<li>堆组织表：记录顺序没有限制，排列顺序不可预测（B+，Hash）</li>
<li>索引组织表</li>
<li>聚簇表：索引聚簇表，散列聚簇表</li>
</ul>
<h3 id="b树"><a class="markdownIt-Anchor" href="#b树"></a> B树</h3>
<p>数据库里面的数据不是一个个存储，是按页存储的。</p>
<p>行数据放在非叶节点中，导致页节点能放的索引项减少，树的层级增多，还是会频繁I/O。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101053814.png" alt="在这里插入图片描述" /></p>
<h3 id="b树索引"><a class="markdownIt-Anchor" href="#b树索引"></a> B+树索引</h3>
<p><mark>使用最广泛，是多级索引</mark></p>
<p>优点：</p>
<ul>
<li>范围查询效率更高</li>
<li>缓存命中率更高（空间局部性原理）</li>
<li>更新维护代价更小</li>
</ul>
<p>特点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mi>m</mi></msub><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log_{m}n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.057252em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>，m为分叉数</p>
<ul>
<li>数据都存储在叶结点，从树根到树叶的所有路径一样长。</li>
<li>叶结点之间有通道可供平行查询。</li>
<li>叶节点包含每个索引键和指向被索引行的指针（行id）</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101039938.png" alt="" /></p>
<h4 id="索引更新"><a class="markdownIt-Anchor" href="#索引更新"></a> 索引更新</h4>
<p>插入删除不会引起过多I/O操作，树仍然平衡，保持了很好性能。</p>
<ul>
<li>I/O密集型</li>
<li>找到应当插入的叶节点</li>
<li>有空间：直接插入</li>
<li>没有空间：将该叶节点分裂成两个，使每个新节点有大于等于一半的键，并且向上直至不用再分裂</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101101145.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101102229.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101103144.png" alt="" /></p>
<p>重复键的处理：用链表存储重复的键值对应的行的RID的值。</p>
<ul>
<li>B+一般三层，需要三次I/O。如果根节点和中间节点存入缓存，只需1次。</li>
<li>何时使用： 当要查询的记录数占记录总数的百分比非常大的时候，不 用索引将比用索引更快</li>
</ul>
<h3 id="hash索引"><a class="markdownIt-Anchor" href="#hash索引"></a> Hash索引</h3>
<p>只需一次I/O。</p>
<p>索引值通过散列函数得到的一样的值全部存储到同一个数据块中。读取是读取整个数据块到内存中，在块中顺序查找目标。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101112860.png" alt="" /></p>
<blockquote>
<p>如果记录很多，可以增加一个溢出块到到桶的链上。</p>
<p><strong>溢出块过多增加I/O次数！！！</strong></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101113786.png" alt="" /></p>
</blockquote>
<p>特点：</p>
<ul>
<li>CPU密集型</li>
<li>等值查找时速度快</li>
<li>不能使用范围查找</li>
<li>不适合在重复值很多的列上建立哈希索引</li>
<li>重构代价大，不适用更新频繁的表</li>
</ul>
<h3 id="聚簇索引"><a class="markdownIt-Anchor" href="#聚簇索引"></a> 聚簇索引</h3>
<p>数据在物理文件中的存放位置不再是无序（堆组织表），根据索引中的键值逻辑顺序</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406101129927.png" alt="" /></p>
<ul>
<li>物理顺序只有一个，一张表只有一个聚簇索引</li>
<li>在聚簇索引列上比B+树快</li>
<li>重复值也排在一起，范围检查也会变快</li>
<li>插入更新快的不用，维护开销大</li>
<li>MySQL在主键上建立</li>
</ul>
<h3 id="联合索引"><a class="markdownIt-Anchor" href="#联合索引"></a> 联合索引</h3>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> tb_a <span class="keyword">where</span> a<span class="operator">&gt;</span><span class="number">1</span> <span class="keyword">and</span> b<span class="operator">=</span><span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>在（a，b）上建立，比单独建立更快。</p>
<ul>
<li>最左前缀原则：只有个使用了最左（即a），才会生效</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emp <span class="keyword">where</span> age<span class="operator">/</span><span class="number">2</span><span class="operator">&gt;</span><span class="number">20</span>;</span><br></pre></td></tr></table></figure>
<p>这样也不生效。</p>
<p>解决方法：改写为<code>age&gt;40</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="operator">*</span> <span class="keyword">from</span> Emp <span class="keyword">where</span>  to_char(birth_day,‘YYYY<span class="operator">-</span>MM<span class="operator">-</span>DD’) <span class="operator">=</span> ‘<span class="number">2022</span><span class="number">-11</span><span class="number">-10</span>’;</span><br></pre></td></tr></table></figure>
<p>解决办法：建立函数索引<code>to_char birth_day,'YYYY-MM-DD</code>。</p>
<p><strong>分类</strong></p>
<p>字段特性：主键索引（非空，一张表一个），唯一索引（unique字段上，一张表可以有多个，索引列值唯一，但可以有空值）和普通索引</p>
<h3 id="查询优化"><a class="markdownIt-Anchor" href="#查询优化"></a> 查询优化</h3>
<ul>
<li>选择运算尽可能先做：减少中间关系</li>
<li>在执行连接操作前对关系适当进行预处理：按连接属性排序，在连接属性上建立索引</li>
<li>投影运算和选择运算同时做：避免重复扫描关系</li>
<li>将投影运算与前面或后面的双目运算结合</li>
</ul>
<h1 id="07-完整性约束"><a class="markdownIt-Anchor" href="#07-完整性约束"></a> 07 完整性约束</h1>
<p>完整性=数据的正确性和相容性</p>
<h2 id="完整性控制机制"><a class="markdownIt-Anchor" href="#完整性控制机制"></a> 完整性控制机制</h2>
<ul>
<li>完整性约束条件定义机制
<ul>
<li>完整性约束条件：数据模型的组成部分，约束数据库中数据的定义</li>
<li><mark>DBMS提供定义数据库完整性约束条件的方法</mark></li>
</ul>
</li>
<li>完整性检查机制：检查用户发出的操作请求是否违背了完整性约束条件</li>
<li>违约反应：如果发现用户的操作请求使数据违背了完整性约束条件，则采取一定的动作来保证数据的完整性</li>
</ul>
<h3 id="完整性规则"><a class="markdownIt-Anchor" href="#完整性规则"></a> 完整性规则</h3>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>D</mi><mo separator="true">,</mo><mi>O</mi><mo separator="true">,</mo><mi>A</mi><mo separator="true">,</mo><mi>C</mi><mo separator="true">,</mo><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(D,O,A,C,P)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span></span></p>
<p>D：约束作用的数据对象</p>
<p>O：触发完整性检查的数据库操作</p>
<p>A：数据对象必须满足的断言或语义约束</p>
<p>C：选择A作用的数据对象值的谓词</p>
<p>P：违反完整性规则时触发的过程</p>
<h2 id="完整性约束条件"><a class="markdownIt-Anchor" href="#完整性约束条件"></a> 完整性约束条件</h2>
<ul>
<li>完整性约束条件作用的对象：列，元组，关系</li>
<li>对象的两种状态：
<ul>
<li>静态：对静态对象的约束是反映数据库状态合理性的约束</li>
<li>动态：对动态对象的约束是反映数据库状态变迁的约束。<font color='purple'><strong>涉及新值和旧值</strong></font></li>
</ul>
</li>
</ul>
<h3 id="分类-2"><a class="markdownIt-Anchor" href="#分类-2"></a> 分类</h3>
<h4 id="分类1"><a class="markdownIt-Anchor" href="#分类1"></a> 分类1</h4>
<ul>
<li>
<p>静态列级约束：取值类型，取值范围，是否为空,check</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> name <span class="keyword">add</span> <span class="keyword">constraint</span> name <span class="keyword">check</span> (sex <span class="keyword">in</span> (<span class="string">&#x27;男&#x27;</span>,<span class="string">&#x27;女&#x27;</span>));</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>静态元组约束：元组间各个列之间的约束关系——用check实现</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> 表名称 <span class="keyword">add</span> <span class="keyword">constraint</span> 约束名称 <span class="keyword">check</span> (发货量<span class="operator">&lt;=</span>订货量);</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>静态关系约束：各个元组之间或若干关系之间存在的各种联系或约束——<font color='purple'><strong>触发器实现</strong></font></p>
<ul>
<li><font color='gray'>职工平均工资的两倍&lt;部门经理的工资</font></li>
</ul>
</li>
<li>
<p>动态列级约束：修改列定义或列值时应满足的约束条件</p>
<ul>
<li>修改列定义时的约束：原来允许空值现在不允许，<strong>数据库自动实现</strong></li>
<li>修改列值时的约束：新旧值之间的约束，<strong>触发器</strong>（eg：年龄只能增长）</li>
</ul>
</li>
<li>
<p>动态元组约束：修改元组值——各个字段之间要满足的约束条件</p>
</li>
<li>
<p>动态关系约束：对关系变化前后状态的限制条件，事务一致性</p>
</li>
</ul>
<h4 id="分类2"><a class="markdownIt-Anchor" href="#分类2"></a> 分类2</h4>
<ul>
<li>域完整性：自定义</li>
<li>实体完整性约束（主键）：每个元组都是可识别的唯一的。不允许无主键&amp;主键值相同</li>
<li>参照完整性约束（外键）：外键值为空&amp;等于所参照关系中的某个元组的主键值</li>
<li>用户自定义约束：Check，触发器</li>
</ul>
<h2 id="违约反应"><a class="markdownIt-Anchor" href="#违约反应"></a> 违约反应</h2>
<ul>
<li>可以拒绝执行</li>
<li>接收操作，同时执行一些附加操作，保证数据库状态正确</li>
</ul>
<h3 id="删除元组"><a class="markdownIt-Anchor" href="#删除元组"></a> 删除元组</h3>
<ul>
<li>级联删除（CASCADES）：自动删除</li>
<li>受限删除（RESTRICTED）：没有对应的正常删除，有拒绝删除</li>
<li>置空值删除（NULLIFILES）：外码值置为空</li>
</ul>
<h3 id="插入元组"><a class="markdownIt-Anchor" href="#插入元组"></a> 插入元组</h3>
<p>若被参照关系不存在响应的元组：</p>
<ul>
<li>受限插入：没有对应的拒绝插入，有对应的可插入</li>
<li>递归插入：先向被参照关系中插入相应元组（主码值等于将要插入的外码值），再向参照关系插入</li>
</ul>
<h3 id="修改元组"><a class="markdownIt-Anchor" href="#修改元组"></a> 修改元组</h3>
<p>修改主键，在参照关系中已经被引用：</p>
<ul>
<li>级联修改：对应外键全部更新</li>
<li>受限修改：没有对应则更新，否则不更新</li>
<li>置空值修改：对应全部置空</li>
</ul>
<h1 id="08-安全"><a class="markdownIt-Anchor" href="#08-安全"></a> 08 安全</h1>
<p><strong>数据共享必然带来数据库的安全问题</strong></p>
<h2 id="安全认证"><a class="markdownIt-Anchor" href="#安全认证"></a> 安全认证</h2>
<p>确认试图登录数据库的用户是否被授权访问数据库的过程</p>
<h3 id="数据库认证"><a class="markdownIt-Anchor" href="#数据库认证"></a> 数据库认证</h3>
<p>使用存储在数据库的信息对连接到数据库的用户进行验证（常用：密码）</p>
<p>缺：容易被盗，难以应对复杂的网络攻击，频繁的验证操作影响性能</p>
<p>加强安全措施：建立密码复杂性标准，密码不包含敏感词，设置时效性</p>
<h3 id="外部认证"><a class="markdownIt-Anchor" href="#外部认证"></a> 外部认证</h3>
<ul>
<li>强身份认证：多因素
<ul>
<li>优：根据需要选择不同身份认证机制，减少数据库管理开销</li>
</ul>
</li>
<li>代理认证：让中央设施对网络的所有成员进行身份验证
<ul>
<li>优：有效解决网络上节点伪造身份，减小开销</li>
</ul>
</li>
</ul>
<h2 id="访问控制"><a class="markdownIt-Anchor" href="#访问控制"></a> 访问控制</h2>
<p>按照用户身份和权限，控制用户对数据库中数据访问</p>
<ul>
<li>阻止访问：无权限</li>
<li>确定访问权限：确定主体是否有权对客体进行访问</li>
<li>授予访问权限：授予主体对访问客体的权限</li>
<li>撤销访问权限：删除访问权限</li>
</ul>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">存</mi><mi mathvariant="normal">取</mi><mi mathvariant="normal">权</mi><mi mathvariant="normal">限</mi><mo>=</mo><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">象</mi><mo>+</mo><mi mathvariant="normal">操</mi><mi mathvariant="normal">作</mi><mi mathvariant="normal">类</mi><mi mathvariant="normal">型</mi></mrow><annotation encoding="application/x-tex">存取权限=数据对象+操作类型
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mord cjk_fallback">存</span><span class="mord cjk_fallback">取</span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">限</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">象</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0em;vertical-align:0em;"></span><span class="mord cjk_fallback">操</span><span class="mord cjk_fallback">作</span><span class="mord cjk_fallback">类</span><span class="mord cjk_fallback">型</span></span></span></span></span></p>
<h3 id="分类-3"><a class="markdownIt-Anchor" href="#分类-3"></a> 分类</h3>
<p>系统权限：</p>
<ul>
<li>
<p>启动、关闭数据库</p>
</li>
<li>
<p>转储、恢复数据库</p>
</li>
<li>
<p>创建、删除数据库</p>
</li>
</ul>
<p>数据对象权限：insert，delete，update表，视图。存储过程等</p>
<p>列级权限</p>
<p>行级权限</p>
<p>连接级权限：连接控制</p>
<h3 id="权限控制语句"><a class="markdownIt-Anchor" href="#权限控制语句"></a> 权限控制语句</h3>
<p>授予grant，收回revoke</p>
<p>授予表级权限：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> tableA <span class="keyword">on</span> userA;</span><br></pre></td></tr></table></figure>
<p>列级权限：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> (a,b) <span class="keyword">on</span> tableA <span class="keyword">on</span> userA;</span><br></pre></td></tr></table></figure>
<p>创建新用户：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">user</span> username identified <span class="keyword">by</span> <span class="string">&#x27;password&#x27;</span>;</span><br></pre></td></tr></table></figure>
<p>授予登录数据库和查看数据的权利：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> usage <span class="keyword">on</span> dbname.<span class="operator">*</span> <span class="keyword">to</span> username@ <span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>谁能授予、收回权限：</p>
<ul>
<li>数据对象的创建者</li>
<li>DBA</li>
<li>拥有传播权限的用户（<code>with grant option</code>）</li>
</ul>
</blockquote>
<p>授予传播权限：</p>
<blockquote>
<p><mark>注意：只能传播已经被赋予<code>with grant option</code>的权限，没有赋予的不能被传播！！</mark></p>
<p>权限不能再传播到授权者或祖先！</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> tableA <span class="keyword">on</span> userA <span class="keyword">with</span> <span class="keyword">grant</span> option;</span><br></pre></td></tr></table></figure>
<h4 id="角色"><a class="markdownIt-Anchor" href="#角色"></a> 角色</h4>
<p>命名的权限集合，方便授权管理。<strong>角色可以基于其他角色（继承）</strong></p>
<ul>
<li>服务器角色：系统自建，不可自建</li>
<li>数据库角色：自建</li>
<li>public角色：所有用户都具有的权限</li>
</ul>
<p>创建角色：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> role roleA;</span><br></pre></td></tr></table></figure>
<p>逐个授予权限：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">insert</span>,<span class="keyword">delete</span> <span class="keyword">on</span> tableA <span class="keyword">to</span> roleA;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">execute</span> <span class="keyword">on</span> procedureA <span class="keyword">to</span> roleA;</span><br></pre></td></tr></table></figure>
<p>赋予指定用户：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> roleA <span class="keyword">to</span> userA;</span><br></pre></td></tr></table></figure>
<h1 id="09-事务管理"><a class="markdownIt-Anchor" href="#09-事务管理"></a> 09 事务管理</h1>
<p>并发控制必须保证数据库一致性，<strong>并发控制以<mark>事务</mark>为基本单位，对事务所操作的数据施加封锁来实现一致性</strong>，<mark>动态关系约束</mark></p>
<p>事务：<mark>不可分割</mark>，全做&amp;全不做，和程序两个概念， 一个对数据库进行操作的应用程序可以包含多个事务，这些事务是<strong>串行</strong>的。</p>
<p>用户自定义的事务以<code>begin transaction</code>开始，<code>commit|rollback</code>结束。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span> TRANSACTION</span><br><span class="line"> READ A</span><br><span class="line"> A<span class="operator">=</span>A－<span class="number">100</span></span><br><span class="line"> IF A<span class="operator">&lt;</span><span class="number">0</span></span><br><span class="line"> <span class="keyword">THEN</span></span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line"> DISPLAY “A款不足”</span><br><span class="line"> <span class="keyword">ROLLBACK</span></span><br><span class="line"> <span class="keyword">END</span></span><br><span class="line"> <span class="keyword">ELSE</span></span><br><span class="line"> <span class="comment">/* 拨款*/</span></span><br><span class="line"> <span class="keyword">BEGIN</span></span><br><span class="line"> READ B</span><br><span class="line"> B<span class="operator">=</span>B<span class="operator">+</span><span class="number">100</span></span><br><span class="line"> DISPLAY “拨款完成”</span><br><span class="line"> <span class="keyword">COMMIT</span></span><br><span class="line"> ENDsql</span><br></pre></td></tr></table></figure>
<p><font color='orange'><strong>事务：并发控制的基本单位，数据恢复的处理单位</strong></font></p>
<p>特征ACID：</p>
<ul>
<li>原子性Atomicity：要不全做，要不全不做；保证只执行了一部分的事务不会对数据库状态产生影响</li>
<li>隔离性Isolation：并发执行的事务不能相互影响</li>
<li>一致性Consistency：事务完成时，所有数据都保持一致状态</li>
<li>持久性Durability：事务一旦提交后，对数据库的影响必须是永久的</li>
</ul>
<p><font color='green'><strong>恢复机制：保证原子性和持久性</strong></font></p>
<p><font color='green'><strong>对事务的并行运行顺序合理安排：事务的隔离性和一致性</strong></font></p>
<h2 id="事务的并发执行"><a class="markdownIt-Anchor" href="#事务的并发执行"></a> 事务的并发执行</h2>
<h3 id="执行状态"><a class="markdownIt-Anchor" href="#执行状态"></a> 执行状态</h3>
<ul>
<li>活动状态：初始</li>
<li>部分提交状态：部分更新，但并未最后结束</li>
<li>失败状态：无法继续进行</li>
<li>终止状态：回滚所有操作，恢复到事务开始以前</li>
<li>提交：正确执行</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102242719.png" alt="" /></p>
<h3 id="并发操作带来的数据不一致性"><a class="markdownIt-Anchor" href="#并发操作带来的数据不一致性"></a> 并发操作带来的数据不一致性</h3>
<ul>
<li>
<p>丢失修改：事务同时修改同一数据,事务2破坏了事务1的提交</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102246088.png" alt="" /></p>
</li>
<li>
<p>不可重复读：事务1读取数据后，事务2执行更新操作，使事务1无法再现前一次读取结果。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102249205.png" alt="" /></p>
<ul>
<li>事务2更新数据</li>
<li>事务2删除数据</li>
<li>事务2插入一些符合事务1条件的数据（后两种叫幻影现象）</li>
</ul>
</li>
<li>
<p>读脏数据：事务2读取数据后，事务1撤销，造成事务2读入了不正确的数据</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102249259.png" alt="" /></p>
</li>
</ul>
<h2 id="并发控制机制"><a class="markdownIt-Anchor" href="#并发控制机制"></a> 并发控制机制</h2>
<h3 id="调度"><a class="markdownIt-Anchor" href="#调度"></a> 调度</h3>
<p>调度是并发运行的事务中各条指令的执行序列（应对各事务所有指令的执行时间顺序做出安排，保留原有的执行顺序）</p>
<p><strong>可串行化的调度</strong>：几个事务的并行执行是正确的，当且仅当其结果与按某一次序串行地执行它们时的结果相同。</p>
<ul>
<li>[x] 冲突可串行化</li>
<li>[ ] 视图可串行化</li>
</ul>
<p><mark>串行调度保证了数据库的一致性</mark></p>
<h4 id="冲突可串行化"><a class="markdownIt-Anchor" href="#冲突可串行化"></a> 冲突可串行化</h4>
<p>只有同时读不冲突，两个指令可以随意调换位置。（调换前后——冲突等价）</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102303549.png" alt="" /></p>
<h5 id="前驱图"><a class="markdownIt-Anchor" href="#前驱图"></a> 前驱图</h5>
<p>画：如果两个事务冲突，且1先访问，那么画一条1—&gt;2的有向边，且在边上标注冲突资源</p>
<p>化简：如果无环—&gt;冲突可串行，利用拓扑排序获得调度顺序</p>
<p><mark>不要在最先访问处画完所有</mark></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102309254.png" alt="" /></p>
<h4 id="可恢复"><a class="markdownIt-Anchor" href="#可恢复"></a> 可恢复</h4>
<p>若事务j读取了事务i之前写入的数据，则i的提交应该早于j，以防出现回滚导致的不一致问题</p>
<p><mark>无级联调度也是可恢复调</mark></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102311193.png" alt="" /></p>
<h4 id="回滚"><a class="markdownIt-Anchor" href="#回滚"></a> 回滚</h4>
<ul>
<li>级联回滚：如果失败，需要连续回滚</li>
<li>无级联调度：可恢复调度，要求高</li>
</ul>
<p><font color='orange'><strong>冲突：可串行，可恢复，最好是无级联</strong></font></p>
<h3 id="锁"><a class="markdownIt-Anchor" href="#锁"></a> 锁</h3>
<p>事务锁定使用的资源以防止其它事务访问/修改。</p>
<ul>
<li>排它锁X：写锁，对数据对象A加上X锁，则只允许T读取和修改A，其他任何事物都不能对A加任何类型锁，直到释放锁</li>
<li>共享锁S：读锁，对数据对象A加S锁，其他事务是能对它加S锁，不能加X锁。</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102317284.png" alt="" /></p>
<h4 id="协议"><a class="markdownIt-Anchor" href="#协议"></a> 协议</h4>
<p>协议内容：何时申请X|S锁，持锁时间，何时释放</p>
<h5 id="一级封锁协议"><a class="markdownIt-Anchor" href="#一级封锁协议"></a> 一级封锁协议</h5>
<p>修改数据就加X锁，直至事务结束；读数据不加锁：防止丢失修改，但不能保证</p>
<p>可重复读:<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102323481.png" alt="" style="zoom:60%;" />不读脏数据：<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102322059.png" alt="" style="zoom: 67%;" /></p>
<h5 id="二级封锁协议"><a class="markdownIt-Anchor" href="#二级封锁协议"></a> 二级封锁协议</h5>
<p>写数据加X锁，读数据加S锁，读完即可释放：保证丢失修改和不读脏数据，不能保证可重复读。</p>
<p>不读脏数据：</p>
<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102326871.png" alt="" style="zoom:67%;" />
<p>不能保证可重复读：</p>
<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102327420.png" alt="" style="zoom:67%;" />
<h5 id="三级封锁协议"><a class="markdownIt-Anchor" href="#三级封锁协议"></a> 三级封锁协议</h5>
<p>修改数据加X锁，读取数据之前加S锁，直至事务结束才释放：可防止丢失修改、读脏数据和不可重复读。</p>
<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102330181.png" alt="" style="zoom:67%;" />
<h5 id="事务隔离级别"><a class="markdownIt-Anchor" href="#事务隔离级别"></a> 事务隔离级别</h5>
<ul>
<li>读未提交：事务A未提交所做的修改也会对事务B的查询有影响——1级</li>
<li>读已提交：事务提交才会产生影响——2级协议</li>
<li>可重复读：当两个事务同时进行时，其中一个事务修改数据对另一个事务不会造成影响， 即使修改的事务已经提交也不会对另一个事务造成影响——低于3级</li>
<li>串行化：两个事务同时进行，即使读取数据也会被锁定，不能被别的事务修改——3级</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102333125.png" alt="" /></p>
<h3 id="两阶段封锁协议2pl"><a class="markdownIt-Anchor" href="#两阶段封锁协议2pl"></a> 两阶段封锁协议2PL</h3>
<p><font color='orange'><strong>不能解决死锁问题</strong></font></p>
<p><mark>能够保证并发执行结果正确性的封锁协议</mark></p>
<p><strong>可解决所有数据不一致问题！！！</strong> 能够保证并发执行结果正确性：获得封锁——释放封锁</p>
<ul>
<li>在对任何数据进行读、写操作之前，事务首先要获得对该数据的封锁</li>
<li>在释放一个封锁之后，事务不再获得任何其他封锁</li>
</ul>
<p><strong><mark>对一组遵守两段锁协议的事务，可以实现可串行化调度，使得其并行执行的结果一定是正确的。但可串行化的调度中，不一定所有事物都必须符合两段锁协议</mark></strong></p>
<p>丢失更新：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102340423.png" alt="" /></p>
<p>不可重复读：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102341655.png" alt="" /></p>
<p>脏读：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406102343225.png" alt="" /></p>
<p>不能解决级联回滚和死锁</p>
<h4 id="严格的两段锁协议"><a class="markdownIt-Anchor" href="#严格的两段锁协议"></a> 严格的两段锁协议</h4>
<p>增加规则：事务获得的锁只有在事务结束时才释放</p>
<p><mark>第三级封锁协议与严格的两阶段锁协议一致</mark></p>
<h2 id="死锁"><a class="markdownIt-Anchor" href="#死锁"></a> 死锁</h2>
<h3 id="预防"><a class="markdownIt-Anchor" href="#预防"></a> 预防</h3>
<p>破坏死锁产生条件</p>
<p>一次封锁法：一次性将所有要使用的数据全部加锁</p>
<h3 id="诊断与解除"><a class="markdownIt-Anchor" href="#诊断与解除"></a> 诊断与解除</h3>
<ul>
<li>允许死锁发生</li>
<li>解决死锁
<ul>
<li>由DBMS的并发控制子系统定期检测系统中是否存在死锁</li>
<li>一旦检测到死锁，就要设法接触</li>
</ul>
</li>
<li>等待图法检测死锁</li>
</ul>
<h1 id="10-备份与恢复"><a class="markdownIt-Anchor" href="#10-备份与恢复"></a> 10 备份与恢复</h1>
<h2 id="分类-4"><a class="markdownIt-Anchor" href="#分类-4"></a> 分类</h2>
<h3 id="逻辑备份恢复"><a class="markdownIt-Anchor" href="#逻辑备份恢复"></a> 逻辑备份恢复</h3>
<ul>
<li>利用sql从数据库提取数据，存入文件。可重新导入数据库中。</li>
<li>DBMS提供的导出&amp;导入实现</li>
<li>备份效率低，影响数据库性能（适用于小型数据库）</li>
</ul>
<h3 id="物理备份恢复"><a class="markdownIt-Anchor" href="#物理备份恢复"></a> 物理备份恢复</h3>
<ul>
<li>基于数据文件和日志文件的备份恢复</li>
<li>效率高，对数据库运行性能影响小</li>
<li>备份策略复杂</li>
</ul>
<p><mark>恢复技术是系统安全性的重要保证，保证事务的原子性和持久性</mark></p>
<ul>
<li>原子性：事务操作全做&amp;全不做</li>
<li>持久性：已提交事务对数据库影响是持久的，未提交事务对数据库没有影响</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111708664.png" alt="" /></p>
<h2 id="缓冲区处理策略"><a class="markdownIt-Anchor" href="#缓冲区处理策略"></a> 缓冲区处理策略</h2>
<ul>
<li>Force：内存中数据最晚在commit时写入磁盘</li>
<li>No Force：内存数据一直保留，commit之后过一段时间写入磁盘（崩溃还没写入，没能持久化）</li>
<li>No Steal：不允许在commit之前写入磁盘</li>
<li>Steal：允许在commit之前写入磁盘</li>
</ul>
<p><strong>最常使用No Force+Steal策略</strong></p>
<h3 id="no-stealforce"><a class="markdownIt-Anchor" href="#no-stealforce"></a> No Steal+Force</h3>
<p>只能在commit时写入。</p>
<h2 id="恢复实现的技术"><a class="markdownIt-Anchor" href="#恢复实现的技术"></a> 恢复实现的技术</h2>
<h3 id="故障分类"><a class="markdownIt-Anchor" href="#故障分类"></a> 故障分类</h3>
<h4 id="事务故障"><a class="markdownIt-Anchor" href="#事务故障"></a> 事务故障</h4>
<p>某个事务在运行过程中未运行至正常终止点就夭折（输入数据有误、运算溢出…）<mark>只影响故障事务 （程序）本身</mark></p>
<p><strong>恢复</strong></p>
<p>撤销事务（UNDO）：对未提交事务进行强行回滚，清除该事务对数据库的所有修改，消除未提交事务的影响。</p>
<h4 id="系统故障"><a class="markdownIt-Anchor" href="#系统故障"></a> 系统故障</h4>
<p>正常运行突然被破坏，所有正在运行的事务都非正常终止，缓冲区信息全部丢失（OS&amp;DBMS代码错误,硬件错误，停电…）<mark>影响到当前正在运行的事务或部分已经运行完结的事务</mark></p>
<p><strong>恢复</strong></p>
<ul>
<li>清除尚未完成的事务对数据库的所有修改：重新启动时，恢复程序强行撤销（UNDO）所有未完成事务</li>
<li>将缓冲区已完成事务提交的结果写入数据库：恢复程序需要重做（REDO）所有已提交的事务</li>
<li>日志文件帮助</li>
</ul>
<h4 id="介质故障"><a class="markdownIt-Anchor" href="#介质故障"></a> 介质故障</h4>
<p>外存数据丢失，破坏性大（磁盘破坏，磁头碰撞…）<mark>影响到内存中的数据和磁盘上的数据</mark></p>
<p><strong>恢复</strong></p>
<ul>
<li>装入数据库发生介质故障前某个时刻的数据副本</li>
<li>重做自此时始所有成功事务，将这些事务已提交的结果重新计入数据库</li>
<li>需要备份数据和日志文件的帮助</li>
</ul>
<h3 id="恢复技术"><a class="markdownIt-Anchor" href="#恢复技术"></a> 恢复技术</h3>
<p><font color='red' background='blue'>冗余</font></p>
<h4 id="数据转储"><a class="markdownIt-Anchor" href="#数据转储"></a> 数据转储</h4>
<p>整个数据库复制到磁带或者另一个磁盘上保存起来。</p>
<ul>
<li>
<p>静态转储：无运行事务时进行转储，转储期间不允许改动数据库。实现简单；但降低了可用性。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111708146.png" alt="" /></p>
</li>
<li>
<p>动态转储：允许转储和用户事务并发运行。优点：不用等待事务结束，也不影响新事务运行；不能保证副本的数据有效。<mark>要把转储期间的修改活动登记，建立日志文件</mark>。恢复时需要日志文件+后备副本。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111708280.png" alt="" /></p>
</li>
<li>
<p>全量存储（海量）：每次转储全部数据文件。</p>
</li>
<li>
<p>增量转储：只转储上次转储后更新过的数据（策略复杂，备份时对数据库影响小）。</p>
</li>
</ul>
<h4 id="登录日志文件"><a class="markdownIt-Anchor" href="#登录日志文件"></a> 登录日志文件</h4>
<p><mark>登记日志文件</mark>（记录事务对数据库的更新操作的文件）：顺序写入效率高，<strong>先写日志文件，再写数据缓冲区，再写入数据文件（便于回退）</strong></p>
<p>文件内容：</p>
<ul>
<li>事务开始标记：begin transaction</li>
<li>结束标记：commit|rollback</li>
<li>更新操作</li>
<li>事务有关的内部更新操作</li>
</ul>
<p>作用：发生<strong>系统故障</strong>，已提交事务重做Redo，未提交撤销Undo</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111716394.png" alt="" /></p>
<h4 id="不同模式的恢复"><a class="markdownIt-Anchor" href="#不同模式的恢复"></a> 不同模式的恢复</h4>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111716785.png" alt="" /></p>
<p>No Steal+Force：已提交的不受影响，未提交的自动回滚。每次事务都要进行磁盘随机写入，但性能很差。</p>
<p>No Steal+No Force：未提交自动回滚，已提交可能还没写到数据文件，日志文件和数据文件不一致（引入Redo日志文件，解决内存数据丢失）</p>
<p>Steal+Force：已提交没有影响，未提交可能被持久化到数据文件，日志文件与数据文件不一致（引入Undo日志文件，清除数据文件中未提交数据）</p>
<p>Steal+No Force：未提交可能被持久化到数据文件，已提交可能还没写到数据文件。（Redo,Undo,Redo/Undo）</p>
<h3 id="恢复策略"><a class="markdownIt-Anchor" href="#恢复策略"></a> 恢复策略</h3>
<h4 id="基于undo日志的恢复策略"><a class="markdownIt-Anchor" href="#基于undo日志的恢复策略"></a> 基于Undo日志的恢复策略</h4>
<h5 id="内容"><a class="markdownIt-Anchor" href="#内容"></a> 内容</h5>
<p>&lt;start t&gt;事务开始，&lt;commit t&gt;事务提交，&lt;abort t&gt;事务被回滚，&lt;t,x,v&gt;t事务已经更新数据项x，其更新前的旧值是v。</p>
<h5 id="规则"><a class="markdownIt-Anchor" href="#规则"></a> 规则</h5>
<ol>
<li>如果事务T更新了数据项X，则日志记录&lt;T,X,v&gt;必须在X被写入磁盘之前写入磁盘。</li>
<li>如果事务T提交，则日志记录必须在T所做的所有更改写入数据文件后才能写入日志文件</li>
</ol>
<p><mark><strong>更新：日志先写；提交：日志后写</strong></mark></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111759133.png" alt="" /></p>
<h5 id="恢复思路"><a class="markdownIt-Anchor" href="#恢复思路"></a> 恢复思路</h5>
<ul>
<li>从日志文件纬度读取日志记录</li>
<li>读到commit|abort标记T为结束状态</li>
<li>读到&lt;T,X,v&gt;如果不是结束状态，就将X=v写入磁盘数据文件</li>
</ul>
<p>恢复的每种操作都是<mark>幂等的</mark>：执行一次或多次结果相同，意味着多次遇到系统故障，重新启动即可恢复，不会影响系统数据</p>
<h4 id="基于redo日志的恢复策略"><a class="markdownIt-Anchor" href="#基于redo日志的恢复策略"></a> 基于Redo日志的恢复策略</h4>
<h5 id="内容-2"><a class="markdownIt-Anchor" href="#内容-2"></a> 内容</h5>
<p>&lt;start t&gt;事务开始，&lt;commit t&gt;事务提交，&lt;abort t&gt;事务被回滚，&lt;t,x,v&gt;t事务已经更新数据项x，其更新前的新值是v。</p>
<h5 id="规则-2"><a class="markdownIt-Anchor" href="#规则-2"></a> 规则</h5>
<p><strong><mark>更新和commit：日志文件先写</mark></strong></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111811519.png" alt="" /></p>
<h5 id="恢复思路-2"><a class="markdownIt-Anchor" href="#恢复思路-2"></a> 恢复思路</h5>
<ul>
<li>查看redo日志，确定事务T是否完成</li>
<li>从日志开头读取日志记录，对于每一个已完成的事务，对它进行重做操作</li>
</ul>
<h5 id="与undo的比较"><a class="markdownIt-Anchor" href="#与undo的比较"></a> 与Undo的比较</h5>
<p>Undo：事务结束先对磁盘进行数据文件写入，性能较差；事务故障时回滚恢复旧值，保证原子性</p>
<p>Redo：可以延后写入数据文件，将已提交的重做，保证持久性，但是不允许steal，灵活性差</p>
<h4 id="基于undoredo的日志恢复策略"><a class="markdownIt-Anchor" href="#基于undoredo的日志恢复策略"></a> 基于Undo/Redo的日志恢复策略</h4>
<h5 id="内容-3"><a class="markdownIt-Anchor" href="#内容-3"></a> 内容</h5>
<p>&lt;start t&gt;事务开始，&lt;commit t&gt;事务提交，&lt;abort t&gt;事务被回滚，&lt;t,x,u,v&gt;t事务已经更新数据项x，其更新前的新值是v，旧值是u。</p>
<h5 id="规则-3"><a class="markdownIt-Anchor" href="#规则-3"></a> 规则</h5>
<p><strong><mark>更新：日志文件先写；commit随意</mark></strong></p>
<h5 id="恢复思路-3"><a class="markdownIt-Anchor" href="#恢复思路-3"></a> 恢复思路</h5>
<ul>
<li>确定各个事务是否已经完成</li>
<li>从日志开头读取，已完成的事务Redo；没提交的事务Undo</li>
</ul>
<h4 id="基于检查点的恢复策略"><a class="markdownIt-Anchor" href="#基于检查点的恢复策略"></a> 基于检查点的恢复策略</h4>
<p>在日志文件中增加检查点，增加一个“重新开始文件”作为日志文件维护状况，最新检查点作为下次恢复工作的起点</p>
<p>检查点记录内容：</p>
<ul>
<li>建立检查点时刻所有正在执行的事务清单</li>
<li>这些事务最近一个日志记录的地址</li>
</ul>
<p>重新开始文件：记录各个检查点记录在日志文件中的地址</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406111818203.png" alt="" /></p>
<h1 id="11-关系数据理论"><a class="markdownIt-Anchor" href="#11-关系数据理论"></a> 11 关系数据理论</h1>
<p>关系数据库的规范化理论包括三个方面的内容：函数依赖（核心），范式（模式分解的标准），模式分解</p>
<p>根据教学管理数据库例子：</p>
<ul>
<li>数据冗余：系名和系主任名字重复存储</li>
<li>插入异常：新开设的系没有学生，无法存入数据库</li>
<li>删除异常：该系所有学生毕业，系仍然存在，但找不到系的信息</li>
<li>更新异常：学生改名，系主任更改</li>
</ul>
<p>分解关系模式：学生，选课，系</p>
<p>好的关系模式：<strong>尽可能少的数据冗余，没有插入异常、删除异常、更新异常</strong></p>
<h2 id="函数依赖"><a class="markdownIt-Anchor" href="#函数依赖"></a> 函数依赖</h2>
<p>关系模式中的各属性之间相互依赖、相互制约的联系称为数据依赖：分为函数依赖、多值依赖和连接依赖。</p>
<p>eg：给出SNO，由于一个学生只能属于一个系，则SN（姓名），AGE，DEPT（系名称）都能被唯一确定，类似于F（x）关系。这里说（SN,AGE,DEPT）函数依赖于SNO。</p>
<p>定义：</p>
<blockquote>
<p>设关系模式R（U，F），U是属性全集，F是U上的函数依赖集，X和Y是U的子集，如果对于R(U)的任意一个可能的关系r，对于X的每一个具体值，Y都有唯一的具体值与之对应，则称X决定函数Y，或Y函数依赖于X，记作X→Y。我们称X为决定因素，Y为依赖因素。当Y不函数依赖于X时，记作：X ⇸Y。当X→Y且Y→X时，则记作：X↔︎Y。</p>
<p>（SNO，CNO）→SCORE，学号+班级号唯一确定成绩</p>
</blockquote>
<h3 id="说明"><a class="markdownIt-Anchor" href="#说明"></a> 说明</h3>
<p><strong>平凡&amp;非平凡</strong></p>
<ul>
<li>平凡的函数依赖：Y是X的子集，（SNO，CNO）→SNO</li>
<li>非平凡的：Y不是X的子集，通常讨论</li>
</ul>
<p><strong>函数依赖是语义范畴的概念</strong></p>
<ul>
<li>要先设定学生不存在重名，SN（学生姓名）→AGE才能成立</li>
</ul>
<p>反应了<mark>语义完整性约束</mark></p>
<p><strong>函数依赖的存在与时间无关</strong></p>
<ul>
<li>所有元组都应该满足约束条件</li>
<li>元组的增加、删除或更新都不能破坏这种函数依赖</li>
</ul>
<p><strong>函数依赖可以保证关系分解的无损连接性</strong></p>
<h3 id="分类-5"><a class="markdownIt-Anchor" href="#分类-5"></a> 分类</h3>
<ul>
<li><strong><u>完全函数依赖</u></strong>：设 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X,Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> 是关系 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 的两个属性集合，如果 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，并且对于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> 的任何一个真子集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">X&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，都有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">!</mo><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X&#x27;!\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> 对 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> 完全函数依赖。
<ul>
<li>C可以通过AB得到，并且C不可以仅通过A得到，也不可以仅通过B得到，那么就说C完全依赖AB。</li>
</ul>
</li>
<li><strong><u>部分函数依赖</u></strong>：对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> 的某个真子集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal">′</mo></msup></mrow><annotation encoding="application/x-tex">X&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>X</mi><mo mathvariant="normal">′</mo></msup><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X&#x27;\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span> 对部分函数依赖。
<ul>
<li>C可以通过AB得到，并且C也可以仅通过A得到，仅通过B得到，那么就说C部分依赖AB。</li>
</ul>
</li>
<li><strong><u>传递函数依赖</u></strong>：设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X,Y,Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>是关系 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span> 中互不相同的属性集合，存在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi><mo stretchy="false">(</mo><mi>Y</mi><mo stretchy="false">!</mo><mo>→</mo><mi>X</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X→Y(Y !→X),Y→Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>，则称 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span> 传递函数依赖于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span> 。
<ul>
<li>B可以通过A得到，C可以通过B得到，那么就称C传递依赖A。</li>
</ul>
</li>
</ul>
<h4 id="定义候选键"><a class="markdownIt-Anchor" href="#定义候选键"></a> 定义候选键</h4>
<blockquote>
<p>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi><msup><mo>→</mo><mi>f</mi></msup><mi>U</mi></mrow><annotation encoding="application/x-tex">K\rightarrow^f U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">→</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10764em;">f</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>（即完全函数依赖），称K为R的一个候选键。如果有多个候选键，选定一个作为主键。</p>
<p>K是R的一个候选键，且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo>⊃</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">S⊃K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>，S是R的超键。</p>
<p>候选键中出现过的为主属性，主属性外的为非主属性。</p>
</blockquote>
<h4 id="定义外键"><a class="markdownIt-Anchor" href="#定义外键"></a> 定义外键</h4>
<blockquote>
<p>关系模式R 中属性或属性组X 并非R 的候选键，但X 是另一个关系模式的候选键，则称X 是R 的外键。</p>
</blockquote>
<h2 id="范式"><a class="markdownIt-Anchor" href="#范式"></a> 范式</h2>
<blockquote>
<p>把关系数据库的规范化过程中为不同程度的规范化要求设立的不同标准称为范式。</p>
</blockquote>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mi>N</mi><mi>F</mi><mo>⊃</mo><mn>2</mn><mi>N</mi><mi>F</mi><mo>⊃</mo><mn>3</mn><mi>N</mi><mi>F</mi><mo>⊃</mo><mi>B</mi><mi>C</mi><mi>N</mi><mi>F</mi><mo>⊃</mo><mn>4</mn><mi>N</mi><mi>F</mi><mo>⊃</mo><mn>5</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">1NF\supset2NF\supset3NF\supset BCNF\supset4NF\supset5NF   
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">1</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">3</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊃</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></span></p>
<p>一级比一级有更严格的要求。</p>
<h3 id="1nf"><a class="markdownIt-Anchor" href="#1nf"></a> 1NF</h3>
<blockquote>
<p>关系中每个属性都是不可再分的简单项。排除了多值属性，组合属性。</p>
<p>错误示例：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221358267.png" alt="" /></p>
</blockquote>
<p>既存在完全函数依赖，又存在部分函数依赖和传递函数依赖。</p>
<p>解决：用投影运算将关系分解，去掉过于复杂的函数依赖关系，向更高一级的范式进行转换。</p>
<h3 id="2nf"><a class="markdownIt-Anchor" href="#2nf"></a> 2NF</h3>
<blockquote>
<p>每个非主属性都完全函数依赖于R的每个关系键。</p>
</blockquote>
<p>解释：数据表里的每一条数据记录，都是可唯一标识的。而且所有非主键字段，都必须完全依赖主键，不能只依赖主键的一部分。</p>
<ul>
<li>从1NF关系中消除非主属性对关系键的部分函数依赖，可得到2NF</li>
<li>如果R的关系键为单属性，或R的全体属性均为主属性，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>2</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in2NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span></li>
</ul>
<h4 id="规范化投影分解"><a class="markdownIt-Anchor" href="#规范化投影分解"></a> 规范化—<strong><mark>投影分解</mark></strong></h4>
<p>选课表：SC(Sid,Sname,Department,Chairman,Lname,Score)</p>
<p>其中，姓名，系名，系主任由学号唯一确定。</p>
<p>所以拆分成两个表：</p>
<p>选课（学号，课名，分数）；学生（学号，姓名，系名，系主任）。</p>
<p>问题：</p>
<ul>
<li>数据冗余：系名和系主任存储次数等于该系学生人数。</li>
<li>插入异常：系没有学生无法插入。</li>
<li>删除异常：某系学生全部毕业，系的相关信息也删除。</li>
<li>更新异常：更换系主任，需要较多改动学生记录。</li>
</ul>
<p>原因：存在着非主属性对主键的传递依赖。</p>
<h3 id="3nf"><a class="markdownIt-Anchor" href="#3nf"></a> 3NF</h3>
<blockquote>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mo>∈</mo><mn>2</mn><mi>N</mi><mi>F</mi></mrow><annotation encoding="application/x-tex">R\in2NF</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>，且每个非主属性都不传递依赖于R的每个关系键。</p>
</blockquote>
<p>学号<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span>系名，系名<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span>系主任。</p>
<p>所以拆分为：</p>
<p>选课（学号，课名，分数）；学生（学号，姓名，系名）；系（系名，系主任）。</p>
<blockquote>
<p>Q:所存在的异常现象已经全部消失。规范化的重点？</p>
<p>A:只限制了非主属性对键的依赖关系，而没有限制主属性对键的依赖关系。还可能出现异常。</p>
</blockquote>
<p>SNC（SNO，SN，CNO，SCORE）假设没有重名，有两个候选键（SNO，CNO）和（SN，CNO）。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221425663.png" alt="" /></p>
<h3 id="bcnf"><a class="markdownIt-Anchor" href="#bcnf"></a> BCNF</h3>
<blockquote>
<p>消除任何属性（主属性或非主属性）对键的部分函数依赖和传递函数依赖。</p>
</blockquote>
<h3 id="规范化"><a class="markdownIt-Anchor" href="#规范化"></a> 规范化</h3>
<h4 id="规范化步骤"><a class="markdownIt-Anchor" href="#规范化步骤"></a> 规范化步骤</h4>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221427417.png" alt="" /></p>
<h4 id="非规范化设计"><a class="markdownIt-Anchor" href="#非规范化设计"></a> 非规范化设计</h4>
<ul>
<li>大量频繁的查询过程所涉及的表都需要进行连接</li>
<li>主要的应用程序在执行时要将表连接起来查询</li>
<li>对数据的计算需要临时表或进行复杂的查询</li>
</ul>
<p><mark>需要维护，占用更多磁盘空间</mark></p>
<h5 id="增加冗余列"><a class="markdownIt-Anchor" href="#增加冗余列"></a> 增加冗余列</h5>
<p>检索一门课的任课教师姓名，class和teacher连接——在class表中增加teacher_name</p>
<h5 id="增加派生列"><a class="markdownIt-Anchor" href="#增加派生列"></a> 增加派生列</h5>
<blockquote>
<p>增加的列来自其他表中的数据，由它们计算生成。</p>
</blockquote>
<p>减少连接操作，避免使用集函数。</p>
<h5 id="重新组表"><a class="markdownIt-Anchor" href="#重新组表"></a> 重新组表</h5>
<blockquote>
<p>需要查看两个表连接起来的结果数据</p>
</blockquote>
<h5 id="分库分表"><a class="markdownIt-Anchor" href="#分库分表"></a> 分库分表</h5>
<ul>
<li>水平分割：一列或多列数据的值把数据行放到两个独立的表中</li>
<li>垂直分割：把主键和一些列放到一个表，然后把主键和另外的列放到 另一个表中（查询所有数据需要join）</li>
</ul>
<h2 id="模式分解"><a class="markdownIt-Anchor" href="#模式分解"></a> 模式分解</h2>
<p><mark>在这些分解方法中，只有能够保证分解后的关系模式与原关系模式等价的方法才是有意义的</mark></p>
<h3 id="数据依赖的公理系统"><a class="markdownIt-Anchor" href="#数据依赖的公理系统"></a> 数据依赖的公理系统</h3>
<p>逻辑蕴含：对于满足一组函数依赖F 的关系模式R ，其任何一个关系r，若函数依赖X→Y都成立, 则称F 逻辑蕴含X →Y</p>
<blockquote>
<p>R&lt;U,F&gt;: U = {A,B,C} F={A-&gt;B,B-&gt;C}<br />
则有，F逻辑蕴含A-&gt;B，AB-&gt;B，A-&gt;C</p>
<p>理由是：A-&gt;B是在F函数依赖集里面显式给出的，AB-&gt;B B属性式AB的一个子集，所以AB必然决定B， A-&gt;C则是通过函数依赖传递得到的。</p>
</blockquote>
<h4 id="armstrong公理系统"><a class="markdownIt-Anchor" href="#armstrong公理系统"></a> Armstrong公理系统</h4>
<blockquote>
<p>一套推理规则，是模式分解算法理论基础。</p>
<p>用于：</p>
<ul>
<li>从一组函数依赖求得蕴含的函数依赖。</li>
<li>求给定关系模式的候选键。</li>
</ul>
</blockquote>
<ul>
<li>自反律：若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>⊆</mo><mi>X</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Y\subseteq X\subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>为F所蕴含。
<ul>
<li>X包含Y，即Y是X的子集，所以必然有X决定Y。<u><strong>平凡的函数依赖</strong></u></li>
</ul>
</li>
<li>增广律：若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>为F所蕴含，且<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Z</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">Z\subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mi>Z</mi><mo>→</mo><mi>Y</mi><mi>Z</mi></mrow><annotation encoding="application/x-tex">XZ\rightarrow YZ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>为F所蕴含。
<ul>
<li>可以在函数依赖两边加一样的属性</li>
</ul>
</li>
<li>传递律：若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>及<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">Y\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>为F所蕴含，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span>为F所蕴含。</li>
</ul>
<p>推论：</p>
<ol>
<li>合并规则：由X→Y，X→Z，有X→YZ</li>
<li>伪传递规则：由X→Y，WY→Z，有XW→Z。</li>
<li>分解规则：由X→Y及 Z含于Y，有X→Z。</li>
</ol>
<h4 id="函数依赖闭包"><a class="markdownIt-Anchor" href="#函数依赖闭包"></a> 函数依赖闭包</h4>
<p>在关系模式R中为F所逻辑蕴含的函数依赖的全体叫作F的闭包，记为F+。</p>
<blockquote>
<p>函数依赖的闭包指F所逻辑蕴含的所有成立的函数依赖，而对于平凡函数依赖（如 （A,B）—&gt;A ）都被F所逻辑蕴含，即便F是一个空集，其闭包也包含很多函数依赖<br />
<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221605751.png" alt="在这里插入图片描述" /></p>
</blockquote>
<h5 id="属性集的闭包"><a class="markdownIt-Anchor" href="#属性集的闭包"></a> 属性集的闭包</h5>
<p>设F为属性集U上的一组函数依赖，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>⊆</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">X\subseteq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>， 则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup><mo>=</mo><mo stretchy="false">{</mo><mi>A</mi><mi mathvariant="normal">∣</mi><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X_F^+ =\{ A | X→A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault">A</span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>能由F 根据Armstrong公理导出} <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>称为属性集X关于函数依赖集F 的闭包。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221610468.png" alt="在这里插入图片描述" /></p>
<p><mark>它将<strong>函数依赖是否成立</strong> 转化为 <strong>属性集闭包</strong>的问题</mark></p>
<p>求属性集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mi>X</mi><mo>⊆</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X(X\subseteq U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>关于U上的函数依赖集F的闭包<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>的算法：</p>
<ul>
<li>输入：X,F</li>
<li>输出：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>步骤：</p>
<ul>
<li>令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">X(0)=X,i=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord">0</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></li>
<li>求B，这里B=\{A|(\exist V)(\exist W)(V\rightarrow W\in F\and V\subseteq X(i)\and A\in W\}</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>B</mi><mo>∪</mo><mi>X</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X(i+1)=B\cup X(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span></li>
<li>判断<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X(i+1)=X(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span>吗？</li>
<li>相等或<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">X(i)=U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span>就是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>，算法终止。</li>
<li>否则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>+</mo><mo>+</mo></mrow><annotation encoding="application/x-tex">i++</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">+</span></span></span></span></li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221620502.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221620097.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221620073.png" alt="" /></p>
<h4 id="最小依赖集"><a class="markdownIt-Anchor" href="#最小依赖集"></a> 最小依赖集</h4>
<p><strong><u>函数依赖集等价</u></strong>：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>G</mi><mo>+</mo></msup><mo>=</mo><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">G^+=F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span>，F覆盖G，或F与G等价。</p>
<p>充分必要条件：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>⊆</mo><msup><mi>G</mi><mo>+</mo></msup><mo separator="true">,</mo><mi>G</mi><mo>⊆</mo><msup><mi>F</mi><mo>+</mo></msup></mrow><annotation encoding="application/x-tex">F\subseteq G^+,G\subseteq F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9657709999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></p>
<p>逐一对F中的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，考察Y是否属于<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mrow><mi>G</mi><mo>+</mo></mrow><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_{G+}^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.163324em;vertical-align:-0.351862em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.406469em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">G</span><span class="mord mtight">+</span></span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.351862em;"><span></span></span></span></span></span></span></span></span></span>即可。</p>
<p><strong><u>最小依赖集</u></strong>：</p>
<ul>
<li>F中任一函数依赖的右部仅含有一个属性。</li>
<li>F中不存在这样的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，使得F与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>−</mo><mo stretchy="false">{</mo><mi>X</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">F-\{X\rightarrow A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mclose">}</span></span></span></span>等价。</li>
<li>F中不存在这样的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，X有真子集Z使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>−</mo><mo stretchy="false">{</mo><mi>X</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo><mo>∪</mo><mrow><mi>Z</mi><mo>→</mo><mi>A</mi></mrow></mrow><annotation encoding="application/x-tex">F-\{X\rightarrow A\}\cup {Z\rightarrow A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">A</span></span></span></span></span>与F等价。</li>
</ul>
<p><mark>最小依赖集构造方法</mark>：</p>
<ul>
<li>逐一检查F中各函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><msub><mi>D</mi><mi>i</mi></msub><mo>:</mo><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">FD_i:X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>，若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi><mo>=</mo><msub><mi>A</mi><mn>1</mn></msub><msub><mi>A</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>k</mi></msub><mo separator="true">,</mo><mi>k</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">Y=A_1A_2...A_k,k&gt;2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>，则用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">{</mo><mi>X</mi><mo>→</mo><msub><mi>A</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>k</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{X\rightarrow A_j|j=1,2,...,k\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">}</span></span></span></span>来取代<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">X\rightarrow Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span></li>
<li>逐一检查F中各函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><msub><mi>D</mi><mi>i</mi></msub><mo>:</mo><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">FD_i:X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>G</mi><mo>=</mo><mi>f</mi><mo>−</mo><mo stretchy="false">{</mo><mi>x</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">G=f-\{x\rightarrow A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mclose">}</span></span></span></span>，若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>∈</mo><msubsup><mi>X</mi><mi>G</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">A\in X_G^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">G</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>，则从F中去掉此函数依赖</li>
<li>逐一检查F中各函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><msub><mi>D</mi><mi>i</mi></msub><mo>:</mo><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">FD_i:X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，设<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>B</mi><mn>1</mn></msub><msub><mi>B</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>B</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">X=B_1B_2...B_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，逐一考察<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>∈</mo><mo stretchy="false">(</mo><mi>X</mi><mo>−</mo><msub><mi>B</mi><mi>i</mi></msub><msub><mo stretchy="false">)</mo><msup><mi>F</mi><mo>+</mo></msup></msub></mrow><annotation encoding="application/x-tex">A\in(X-B_i)_{F^+}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.341865em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7026642857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则以<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>−</mo><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">X-B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05017em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>取代X</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221642528.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221642847.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221642533.png" alt="" /></p>
<h3 id="模式分解的判定依据"><a class="markdownIt-Anchor" href="#模式分解的判定依据"></a> 模式分解的判定依据</h3>
<h4 id="无损连接性"><a class="markdownIt-Anchor" href="#无损连接性"></a> 无损连接性</h4>
<blockquote>
<p>分解前与分解后自然连接的结果相等。保证不丢失信息。</p>
<p>不一定能解决插入异常、删除异常等问题</p>
</blockquote>
<h5 id="列表法"><a class="markdownIt-Anchor" href="#列表法"></a> 列表法</h5>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dyyay521/article/details/111874768">数据库手把手解题——1.判断无损连接_数据库无损连接的判断-CSDN博客</a></p>
<h5 id="定理法"><a class="markdownIt-Anchor" href="#定理法"></a> 定理法</h5>
<blockquote>
<p>适合关系模式R分解为两个关系模式R1、R2的</p>
</blockquote>
<p>若关系模式R&lt;U,F&gt;中，被分解为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>ρ</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>R</mi><mn>1</mn></msub><mo>&lt;</mo><msub><mi>U</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>1</mn></msub><mo>&gt;</mo><mo separator="true">,</mo><msub><mi>R</mi><mn>2</mn></msub><mo>&lt;</mo><msub><mi>U</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>F</mi><mn>2</mn></msub><mo>&gt;</mo><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\rho=\{R_1&lt;U_1,F_1&gt;,R_2&lt;U_2,F_2&gt;\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">ρ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mclose">}</span></span></span></span>是R的一个分解，若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>R</mi><mn>2</mn></msub><mo>→</mo><msub><mi>R</mi><mn>1</mn></msub><mo>−</mo><msub><mi>R</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">R_1\cap R_2\rightarrow R_1-R_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>或者<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>R</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>R</mi><mn>2</mn></msub><mo>→</mo><msub><mi>R</mi><mn>2</mn></msub><mo>−</mo><msub><mi>R</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">R_1\cap R_2\rightarrow R_2-R_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，则具有无损连接性</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221719942.png" alt="" /></p>
<blockquote>
<p>一个分解具有无损连接性，能够保证不丢失信息。</p>
<p>一个分解保持了函数依赖，可以减轻或解决各种异常情况。</p>
<p>两者相互独立。</p>
</blockquote>
<h4 id="保持函数依赖"><a class="markdownIt-Anchor" href="#保持函数依赖"></a> 保持函数依赖</h4>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221722576.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221722073.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221725695.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221726669.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221726764.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221727943.png" alt="" /></p>
<h1 id="12-数据库设计"><a class="markdownIt-Anchor" href="#12-数据库设计"></a> 12 数据库设计</h1>
<h2 id="概述"><a class="markdownIt-Anchor" href="#概述"></a> 概述</h2>
<ul>
<li>静态的数据库结构设计：根据给定的应用环境，进行数据库的模式的设计
<ul>
<li>直观设计法：缺乏理论依据</li>
<li>规范设计法：需求分析，概念设计，逻辑设计，物理设计</li>
</ul>
</li>
<li>动态的数据库行为设计</li>
</ul>
<h2 id="需求分析"><a class="markdownIt-Anchor" href="#需求分析"></a> 需求分析</h2>
<p>重点是调查、收集与分析用户在数据管理中的：</p>
<ul>
<li>信息要求</li>
<li>处理要求：响应时间，处理方式</li>
<li>安全性和完整性要求：形成需求文档</li>
</ul>
<p>分析和表达用户的需求的常用方法：</p>
<ul>
<li>自顶向下的结构化分析方法（SA）：数据流图和数据字典</li>
<li>面向对象的分析方法</li>
</ul>
<h3 id="数据流图"><a class="markdownIt-Anchor" href="#数据流图"></a> 数据流图</h3>
<p>用特定的符号反映系统的数据传递和变换过程的图。</p>
<p>组成：数据流<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">→</span></span></span></span>，处理（椭圆），数据存储（=），实体（□）</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241516375.png" alt="" /></p>
<h3 id="数据字典"><a class="markdownIt-Anchor" href="#数据字典"></a> 数据字典</h3>
<p>进行详细的数据收集和数据分析所获得主要结果</p>
<p>组成：</p>
<ul>
<li>数据项<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241518042.png" alt="" style="zoom:50%;" /></li>
<li>数据结构<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241518366.png" alt="" style="zoom:50%;" /></li>
<li>数据流<img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241519682.png" alt="" style="zoom: 50%;" /></li>
<li>数据存储</li>
<li>处理过程</li>
</ul>
<h2 id="概念结构设计"><a class="markdownIt-Anchor" href="#概念结构设计"></a> 概念结构设计</h2>
<p>ER图</p>
<h2 id="逻辑结构设计"><a class="markdownIt-Anchor" href="#逻辑结构设计"></a> 逻辑结构设计</h2>
<p>由ER图向关系模型转换</p>
<p>设计用户子模式（定义视图）</p>
<h1 id="13-nosql与云数据库"><a class="markdownIt-Anchor" href="#13-nosql与云数据库"></a> 13 NoSQL与云数据库</h1>
<h2 id="分布式数据库"><a class="markdownIt-Anchor" href="#分布式数据库"></a> 分布式数据库</h2>
<h3 id="起源bigtable"><a class="markdownIt-Anchor" href="#起源bigtable"></a> 起源—BigTable</h3>
<p>解决google的大规模网页搜索问题</p>
<ul>
<li>底层数据存储：GFS</li>
<li>处理海量数据：利用谷歌提出的MapReduce分布式并行计算模型</li>
<li>协同服务管理：采用Chubby所提供的能力</li>
<li>可扩展能力：数据到PB级、机器达上千台</li>
</ul>
<h3 id="hbase概述"><a class="markdownIt-Anchor" href="#hbase概述"></a> HBase概述</h3>
<p>BigTable开源实现：目标是处理非常庞大的表。</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221538402.png" alt="" /></p>
<ul>
<li>解决大规模数据的离线批量处理问题</li>
<li>克服了RDB面对大规模数据时系统扩展性和性能差问题</li>
<li>克服了RDB难于处理非结构化与半结构化数据的缺陷</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221539764.png" alt="" /></p>
<p>数据模型：</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221546756.png" alt="" /></p>
<h2 id="nosql非关系型数据库"><a class="markdownIt-Anchor" href="#nosql非关系型数据库"></a> NoSQL非关系型数据库</h2>
<ul>
<li>灵活的可扩展性</li>
<li>灵活的数据模型</li>
<li>与云计算紧密结合</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241936833.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241937894.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241945917.png" alt="" /></p>
<h2 id="nosql技术特点"><a class="markdownIt-Anchor" href="#nosql技术特点"></a> NoSQL技术特点</h2>
<ul>
<li>
<p>键值数据库：键值对。键是字符串对象，值是任意类型。</p>
<ul>
<li>优：扩展性好，灵活性好，大量写操作时性能高。</li>
<li>缺：无法存储结构化信息，条件查询效率低。不适用通过值而非键来查</li>
</ul>
</li>
<li>
<p>列族数据库：分布式数据存储与管理</p>
<ul>
<li>优：查找速度快，可扩展性强，容易进行分布式扩展，复杂性低</li>
<li>低：功能较少，不支持强事务一致性</li>
<li>不适用需要ACID事务支持的情形</li>
</ul>
</li>
<li>
<p>文档数据库：用于存储并检索文档数据，<mark>可以基于文档内容构建索引（区别于键值数据库）</mark></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406241955684.png" alt="" /></p>
<ul>
<li>优：数据不规则，数据迁移容易，ACID保证，读写速度快</li>
<li>缺：缺乏统一的查询语法</li>
</ul>
</li>
<li>
<p>图形数据库：图结构，专门用于处理具有高度相互关联关系的数据</p>
<ul>
<li>优：灵活性高，支持复杂的图形算法</li>
<li>缺：复杂性高，只能支持一定的数据规模</li>
</ul>
</li>
<li>
<p>搜索数据库：</p>
</li>
<li>
<p>时序数据库：</p>
</li>
</ul>
<h3 id="nosql三大基石"><a class="markdownIt-Anchor" href="#nosql三大基石"></a> NoSQL三大基石</h3>
<p><mark><strong>最终一致性，CAP，BASE</strong></mark></p>
<h4 id="cap"><a class="markdownIt-Anchor" href="#cap"></a> CAP</h4>
<ul>
<li>Consistency一致性：任何一个读操作总能读到之前完成的写操作的结果</li>
<li>Availability可用性：快速获取数据，不管成功失败都有响应</li>
<li>Tolerance of Network Partition分区容忍性：当出现网络分区情况时，分离的系统也能够正常运行</li>
</ul>
<p><strong>一个分布式系统最多只能同时满足其两个</strong></p>
<ul>
<li>CA：把所有与事务相关的内容都放到同一台机器上（传统关系数据库），延展性差</li>
<li>CP：当出现网络分区的情况时，受影响的服务需要等待数据一致，在等待期间无法对外提供服务</li>
<li>AP：允许系统返回不一致的数据</li>
</ul>
<h4 id="base"><a class="markdownIt-Anchor" href="#base"></a> BASE</h4>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406242007044.png" alt="" /></p>
<ul>
<li>基本可用：允许分区失败的情形出现</li>
<li>软状态：可以有一段时间不同步，有一定的滞后性</li>
<li>最终一致性（弱一致性的一种特例）：允许暂时读不到更新后的数据，但是经过一段时间后，必须最终读到更新后的数据</li>
</ul>
<h2 id="云数据库"><a class="markdownIt-Anchor" href="#云数据库"></a> 云数据库</h2>
<p>部署和虚拟化在云计算环境中的数据库</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406242011066.png" alt="" /></p>
<h1 id="final"><a class="markdownIt-Anchor" href="#final"></a> Final</h1>
<h2 id="选择"><a class="markdownIt-Anchor" href="#选择"></a> 选择</h2>
<h3 id="概论"><a class="markdownIt-Anchor" href="#概论"></a> 概论</h3>
<h4 id="dbdbmsdbadbs"><a class="markdownIt-Anchor" href="#dbdbmsdbadbs"></a> DB,DBMS,DBA,DBS</h4>
<ul>
<li>DB数据库：按一定结构组织并长期存储在计算机内的、可共享的大量数据的有机集合。</li>
<li>DBMS数据库管理系统：是管理和维护数据库的系统软件。MySQL，Oracle</li>
<li>DBA管理操作数据库人员</li>
<li>DBS数据库系统：基于数据库建立的一种信息系统，通常由应用程序、数据库DB、数据库管理系统DBMS和用户组成</li>
</ul>
<h4 id="与文件系统比较"><a class="markdownIt-Anchor" href="#与文件系统比较"></a> 与文件系统比较</h4>
<ul>
<li>数据冗余度大；一个文件对应一个应用程序，数据不能共享</li>
<li>数据独立性低：一旦改变数据的逻辑结构，必须修改相应的应用程序</li>
<li>数据的一致性差</li>
</ul>
<h2 id="问答"><a class="markdownIt-Anchor" href="#问答"></a> 问答</h2>
<h3 id="数据库系统特点"><a class="markdownIt-Anchor" href="#数据库系统特点"></a> 数据库系统特点</h3>
<ul>
<li>数据结构化</li>
<li>数据共享</li>
<li>数据独立性</li>
<li>方便的用户接口</li>
<li>同一的数据管理与控制功能</li>
</ul>
<h3 id="存储过程优点"><a class="markdownIt-Anchor" href="#存储过程优点"></a> 存储过程优点</h3>
<ul>
<li>是SQL与模块化编程的结合，能够完成复杂业务功能</li>
<li>在创建的时候进行预编译，可以提高SQL执行效率</li>
<li>位于数据库服务器上，调用的时候无需通过网络传输大量数据</li>
<li>可以作为一种安全机制来加以充分利用，例如参数化的存储过程可以防止SQL注入式攻击</li>
</ul>
<h3 id="游标的主要功能"><a class="markdownIt-Anchor" href="#游标的主要功能"></a> 游标的主要功能</h3>
<ul>
<li>定位到结果集中的指定行</li>
<li>从结果集的当前位置检索一行或多行</li>
<li>可对结果集中当前位置的行进行数据修改</li>
<li>可以显示其他用户对结果集中的数据库函数进行的数据修改</li>
</ul>
<h3 id="orm"><a class="markdownIt-Anchor" href="#orm"></a> ORM</h3>
<p>在关系型数据库和对象之间做映射。在操作数据库时不需要SQL，直接像操作对象一样操作它。</p>
<ul>
<li>提高开发效率</li>
<li>数据库平台透明</li>
<li>数据库结构自动维护</li>
<li>代码可读性高</li>
</ul>
<h3 id="数据库设计新奥尔良法基本步骤"><a class="markdownIt-Anchor" href="#数据库设计新奥尔良法基本步骤"></a> 数据库设计（新奥尔良法）基本步骤</h3>
<ul>
<li>需求分析阶段 ：准确了解与分析用户需求</li>
<li>概念结构设计阶段 ：对用户需求进行综合、归纳与抽象，形成一个独立于具体DBMS的概念模型</li>
<li>逻辑结构设计阶段 ：将概念结构转换为某个DBMS所支持的数据模型</li>
<li>物理结构设计阶段 ：为逻辑数据模型选取一个最适合应用环境的物理结构</li>
<li>数据库实施阶段：运用DBMS提供的数据语言、工具及宿主语言，根据逻辑设计和物理设计的结果</li>
<li>数据库运行和维护阶段：经过试运行后即可投入正式运行</li>
</ul>
<h3 id="视图-2"><a class="markdownIt-Anchor" href="#视图-2"></a> 视图</h3>
<p>作用：</p>
<ul>
<li>简化用户的操作</li>
<li>使用户能以多种角度看待同一数据</li>
<li>对重构数据库提供了一定程度的逻辑独立性</li>
<li>对机密数据提供安全保护</li>
</ul>
<h3 id="触发器-2"><a class="markdownIt-Anchor" href="#触发器-2"></a> 触发器</h3>
<p>触发器主要是通过事件进行触发而被执行的，而存储过程可以通过存储过程名字而被直接调用。</p>
<p>作用：</p>
<ul>
<li>强化约束：触发器能够实现比CHECK 语句更为复杂的约束。</li>
<li>跟踪变化：触发器可以侦测数据库内的操作，从而不允许数据库中未经许可的指定更新和变化。</li>
<li>级联运行：触发器可以侦测数据库内的操作，并自动地级联影响整个数据库的各项内容。例如，某个表上的触发器中包含有对另外一个表的数据操作(如删除，更新，插入)而该操作又导致该表上触发器被触发。</li>
<li>存储过程的调用：为了响应数据库更新,触发器可以调用一个或多个存储过程，甚至可以通过外部过程的调用而在DBMS( 数据库管理系统)本身之外进行操作。</li>
</ul>
<h2 id="大题"><a class="markdownIt-Anchor" href="#大题"></a> 大题</h2>
<h3 id="关系代数-2"><a class="markdownIt-Anchor" href="#关系代数-2"></a> 关系代数</h3>
<p>相同属性连接直接自然连接——<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⋈</mo></mrow><annotation encoding="application/x-tex">\bowtie</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.51em;vertical-align:-0.005em;"></span><span class="mrel">⋈</span></span></span></span></p>
<p>不同属性连接用笛卡尔积+判断条件——<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">.</mi><mi>n</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>b</mi><mi mathvariant="normal">.</mi><mi>b</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sigma(a.num=b.boss)(A\times B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mord">.</span><span class="mord mathdefault">n</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord">.</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span></p>
<p><strong><u><mark>至少|所有类问题</mark></u></strong></p>
<p>记得用除（就是选择符合被除属性的其余属性项）！！</p>
<ol>
<li>查询选了所有课程的学生姓名<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mo>∏</mo><mrow><mi>S</mi><mi>N</mi><mi>A</mi><mi>M</mi><mi>E</mi></mrow></munder><mo stretchy="false">(</mo><munder><mo>∏</mo><mrow><mi>C</mi><mi>N</mi><mi>O</mi><mo separator="true">,</mo><mi>S</mi><mi>N</mi><mi>O</mi></mrow></munder><mo stretchy="false">(</mo><mi>S</mi><mi>C</mi><mo stretchy="false">)</mo><mo>÷</mo><munder><mo>∏</mo><mrow><mi>C</mi><mi>N</mi><mi>O</mi></mrow></munder><mo stretchy="false">(</mo><mi>C</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⋈</mo><mo stretchy="false">(</mo><mi>S</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\prod_{SNAME}(\prod_{CNO,SNO}(SC)÷\prod_{CNO}(C))\bowtie(S)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.480449em;vertical-align:-1.430444em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight">A</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">E</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8556639999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.05764em;">S</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.430444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">÷</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.344341em;vertical-align:-1.294336em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07153em;">C</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⋈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mclose">)</span></span></span></span></span></p>
</li>
</ol>
<p>查找教的学生的成绩都大于60分的教师（给出教师号即可）：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mo>∏</mo><mrow><mi>T</mi><mi>N</mi><mi>O</mi></mrow></munder><mo stretchy="false">(</mo><mi>S</mi><mi>C</mi><mo stretchy="false">)</mo><mo>−</mo><munder><mo>∏</mo><mrow><mi>T</mi><mi>N</mi><mi>O</mi></mrow></munder><mo stretchy="false">(</mo><msub><mi>σ</mi><mrow><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>&lt;</mo><mo>=</mo><mn>60</mn></mrow></msub><mo stretchy="false">(</mo><mi>S</mi><mi>C</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\prod_{TNO}(SC)-\prod_{TNO}(\sigma_{score&lt;=60}(SC))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.344341em;vertical-align:-1.294336em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.344341em;vertical-align:-1.294336em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0500050000000003em;"><span style="top:-1.855664em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">O</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.294336em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">c</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">e</span><span class="mrel mtight">&lt;</span><span class="mrel mtight">=</span><span class="mord mtight">6</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.17737em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p>查找张三的直属领导和直属下级的员工编号：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mo>∏</mo><mrow><mi>n</mi><mi>u</mi><mi>m</mi></mrow></munder><mo stretchy="false">(</mo><mi>σ</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>e</mi><mn>1.</mn><mi>b</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>e</mi><mn>2.</mn><mi>n</mi><mi>u</mi><mi>m</mi><mtext> </mtext><mi>o</mi><mi>r</mi><mtext> </mtext><mi>e</mi><mn>1.</mn><mi>n</mi><mi>u</mi><mi>m</mi><mo>=</mo><mi>e</mi><mn>2.</mn><mi>b</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy="false">)</mo><mtext> </mtext><mi>a</mi><mi>n</mi><mi>d</mi><mtext> </mtext><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><msup><mo>=</mo><mo mathvariant="normal">′</mo></msup><mi mathvariant="normal">张</mi><msup><mi mathvariant="normal">三</mi><mo mathvariant="normal">′</mo></msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>e</mi><mi>m</mi><mi>p</mi><mn>1</mn><mo>×</mo><mi>e</mi><mi>m</mi><mi>p</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\prod_{num}(\sigma((e1.boss=e2.num\ or\ e1.num=e2.boss)\ and\ name=&#x27;张三&#x27;)(emp1\times emp2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3000100000000003em;vertical-align:-1.250005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.050005em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∏</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord">1</span><span class="mord">.</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">e</span><span class="mord">2</span><span class="mord">.</span><span class="mord mathdefault">n</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mspace"> </span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace"> </span><span class="mord mathdefault">e</span><span class="mord">1</span><span class="mord">.</span><span class="mord mathdefault">n</span><span class="mord mathdefault">u</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord">2</span><span class="mord">.</span><span class="mord mathdefault">b</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mclose">)</span><span class="mspace"> </span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord mathdefault">d</span><span class="mspace"> </span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel">=</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.051892em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">张</span><span class="mord"><span class="mord cjk_fallback">三</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="sql"><a class="markdownIt-Anchor" href="#sql"></a> SQL</h3>
<p><strong><mark>默认是保留重复的行（ALL），消除取值重复的行DISTINCT</mark></strong></p>
<blockquote>
<p>作用范围是所有目标列，<strong>写一个就好！！！</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> sno <span class="keyword">from</span> sc;</span><br></pre></td></tr></table></figure>
<p>ASC升序，DESC降序</p>
<h4 id="相关子查询"><a class="markdownIt-Anchor" href="#相关子查询"></a> 相关子查询</h4>
<p>查询员工中工资大于本部门平均工资的员工的name, salary和department_id</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> name,salary,deparment_id <span class="keyword">from</span> e1 <span class="keyword">where</span> salary<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(salary) <span class="keyword">from</span> employees e2 <span class="keyword">where</span> department_id<span class="operator">=</span>e1.department_id);</span><br></pre></td></tr></table></figure>
<p>查询选修了全部课程的学生姓名：</p>
<blockquote>
<p>理解为查询一个人的姓名，这个人不存在课程没有选择。</p>
<p>1.拿出student表中的一行数据</p>
<p>2.拿出课程表的一行数据</p>
<p>3.拿出sc表的一行数据，对比判断是否选择了</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname <span class="keyword">from</span> student <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span>(<span class="keyword">select</span> <span class="operator">*</span> course <span class="keyword">where</span> <span class="keyword">not</span> <span class="keyword">exists</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sc <span class="keyword">where</span> sc.sno<span class="operator">=</span>student.sno <span class="keyword">and</span> sc.cno<span class="operator">=</span>c.cno));</span><br></pre></td></tr></table></figure>
<p>或者直接查询选择的课程数是否等于全部课程数：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> sname,sno <span class="keyword">from</span> s,sc <span class="keyword">where</span> s.sno<span class="operator">=</span>sc.sno <span class="keyword">group</span> <span class="keyword">by</span> sno <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">=</span><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> c;</span><br></pre></td></tr></table></figure>
<p><mark>最多最少问题</mark>：</p>
<ul>
<li>使用ALL，ANY</li>
<li>通过子查询比较</li>
</ul>
<p>查询被单个学生重修次数最多的课程号、课程名、教师名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> cno <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sno,cno <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;=</span><span class="keyword">all</span>(<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> sc <span class="keyword">group</span> <span class="keyword">by</span> sno,cno <span class="keyword">having</span> <span class="built_in">count</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p>查询员工平均薪资最高的部门（可能有多个）：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> dept <span class="keyword">from</span> emp e1 <span class="keyword">group</span> <span class="keyword">by</span> dept <span class="keyword">having</span> <span class="built_in">avg</span>(salary)<span class="operator">&gt;=</span><span class="keyword">all</span>(<span class="keyword">select</span> <span class="built_in">avg</span>(salary) <span class="keyword">from</span> emp e2 <span class="keyword">group</span> <span class="keyword">by</span> dept);</span><br></pre></td></tr></table></figure>
<h4 id="dml"><a class="markdownIt-Anchor" href="#dml"></a> DML</h4>
<p>创建表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_name(</span><br><span class="line">	sid <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">primary</span> key,</span><br><span class="line">	sname <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">	count <span class="type">int</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>insert:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_name(sid,sname,count) </span><br><span class="line"><span class="keyword">select</span> s.sid <span class="keyword">as</span> sid,s.sname <span class="keyword">as</span> sname,<span class="built_in">count</span>(sc.cid) <span class="keyword">as</span> count <span class="keyword">from</span> s,sc <span class="keyword">where</span> s.sid<span class="operator">=</span>sc.sid <span class="keyword">group</span> <span class="keyword">by</span> sid;</span><br></pre></td></tr></table></figure>
<p>将学生的重修课程成绩都改成60分：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> sc s1 <span class="keyword">set</span> score<span class="operator">=</span><span class="number">60</span> <span class="keyword">where</span> stime<span class="operator">&gt;</span>(<span class="keyword">select</span> <span class="built_in">min</span>(stime) <span class="keyword">from</span> sc s2 <span class="keyword">where</span> s1.sno<span class="operator">=</span>s2.sno <span class="keyword">and</span> s1.cno<span class="operator">=</span>s2.cno);</span><br></pre></td></tr></table></figure>
<h4 id="视图-3"><a class="markdownIt-Anchor" href="#视图-3"></a> 视图</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">view</span> view_name[列名<span class="number">1</span>,列名<span class="number">2</span>,列名<span class="number">3</span>]</span><br><span class="line"><span class="keyword">as</span></span><br><span class="line">子查询</span><br><span class="line">[<span class="keyword">with</span> <span class="keyword">check</span> option];</span><br></pre></td></tr></table></figure>
<p><code>with check option</code>：透过视图进行增删改操作时，不得破坏视图定义中的谓词条件（即子查询中的条件表达式）</p>
<p>eg：</p>
<p>创建一个视图，列出每个比同类别商品平均价格高的商品的ID、名称、价格、部门平均价格。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> 高于平均价格的商品视图 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    商品.商品ID,</span><br><span class="line">    商品.名称,</span><br><span class="line">    商品.价格,</span><br><span class="line">    商品.类别,</span><br><span class="line">    <span class="built_in">AVG</span>(同类别商品.价格) <span class="keyword">AS</span> 平均价格</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    商品</span><br><span class="line"><span class="keyword">JOIN</span> </span><br><span class="line">    商品 <span class="keyword">AS</span> 同类别商品 <span class="keyword">ON</span> 商品.类别 <span class="operator">=</span> 同类别商品.类别</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> </span><br><span class="line">    商品.商品ID, 商品.名称, 商品.价格, 商品.类别</span><br><span class="line"><span class="keyword">HAVING</span> </span><br><span class="line">    商品.价格 <span class="operator">&gt;</span> <span class="built_in">AVG</span>(同类别商品.价格);</span><br></pre></td></tr></table></figure>
<h3 id="事务管理"><a class="markdownIt-Anchor" href="#事务管理"></a> 事务管理</h3>
<h4 id="前驱图检查冲突可串行性"><a class="markdownIt-Anchor" href="#前驱图检查冲突可串行性"></a> 前驱图检查冲突可串行性</h4>
<p>冲突：读—写，写—写</p>
<p><mark>不要在最先访问处画完所有</mark></p>
<p>化简：如果无环—&gt;冲突可串行，利用拓扑排序获得调度顺序</p>
<h4 id="两段锁协议"><a class="markdownIt-Anchor" href="#两段锁协议"></a> 两段锁协议</h4>
<ul>
<li>两段锁2PL：所有的数据库操作有可能会要求加锁，并且释放锁。这一切都发生在事务内部。</li>
<li>严格两段锁：必须要等到事务完成（提交|回滚）才能释放锁。</li>
</ul>
<h3 id="备份与恢复"><a class="markdownIt-Anchor" href="#备份与恢复"></a> 备份与恢复</h3>
<blockquote>
<p>级联回滚：某些事务用到了回滚的事务修改的数据。</p>
</blockquote>
<h4 id="undo"><a class="markdownIt-Anchor" href="#undo"></a> Undo</h4>
<p><mark><strong>更新：日志先写；提交：日志后写</strong></mark></p>
<p>解决Steal+Force，未提交事务提早写入磁盘，已提交事务一定写入磁盘。</p>
<p>恢复：回滚未提交事务</p>
<ul>
<li>从日志文件纬度读取日志记录</li>
<li>读到commit|abort标记T为结束状态</li>
<li>读到&lt;T,X,v&gt;如果不是结束状态，就将X=v写入磁盘数据文件</li>
</ul>
<h4 id="redo"><a class="markdownIt-Anchor" href="#redo"></a> Redo</h4>
<p><mark><strong>更新和commit：日志文件先写</strong></mark></p>
<p>解决No Steal+No Force，已经提交事务可能没有写入磁盘，未提交的一定没有写入磁盘。</p>
<p>恢复：重做已提交的事务</p>
<ul>
<li>查看redo日志，确定事务T是否完成</li>
<li>从日志开头读取日志记录，对于每一个已完成的事务，对它进行重做操作</li>
</ul>
<h4 id="undoredo"><a class="markdownIt-Anchor" href="#undoredo"></a> Undo/Redo</h4>
<p><strong><mark>更新：日志文件先写；commit随意</mark></strong></p>
<p>解决Steal+No Force，已提交的可能没写入磁盘，未提交的可能已写入磁盘。</p>
<p>恢复：重做已完成的，撤销没完成的</p>
<ul>
<li>确定各个事务是否已经完成</li>
<li>从日志开头读取，已完成的事务Redo；没提交的事务Undo</li>
</ul>
<h3 id="规范化理论"><a class="markdownIt-Anchor" href="#规范化理论"></a> 规范化理论</h3>
<h4 id="求闭包"><a class="markdownIt-Anchor" href="#求闭包"></a> 求闭包</h4>
<p>求属性集<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo stretchy="false">(</mo><mi>X</mi><mo>⊆</mo><mi>U</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X(X\subseteq U)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="mclose">)</span></span></span></span>关于U上的函数依赖集F的闭包<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>X</mi><mi>F</mi><mo>+</mo></msubsup></mrow><annotation encoding="application/x-tex">X_F^+</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104993em;vertical-align:-0.293531em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.4064690000000004em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">F</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.293531em;"><span></span></span></span></span></span></span></span></span></span>：</p>
<p>先将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>放入结果，通过已有都能确定什么。</p>
<h4 id="求候选键"><a class="markdownIt-Anchor" href="#求候选键"></a> 求候选键</h4>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>类属性：只在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>中某个函数依赖的左部出现</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>：只在右出现</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">LR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>：左右都出现</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>：没有出现过</li>
</ul>
<p>步骤：</p>
<ul>
<li>求解<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo separator="true">,</mo><mi>L</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">N,LR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>类属性</li>
<li>若<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">,</mo><mi>N</mi><msup><mo stretchy="false">)</mo><mo>+</mo></msup><mo>=</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">(L,N)^+=U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.021331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>,则<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(L,N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>为唯一候选键</li>
<li>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">,</mo><mi>N</mi><msup><mo stretchy="false">)</mo><mo>+</mo></msup><mi mathvariant="normal">≠</mi><mi>U</mi></mrow><annotation encoding="application/x-tex">(L,N)^+\neq U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.021331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则找<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">LR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>类</li>
<li>遍历<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">LR</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span>中的单一属性<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">,</mo><mi>N</mi><mo separator="true">,</mo><mi>A</mi><msup><mo stretchy="false">)</mo><mo>+</mo></msup><mo>=</mo><mi>U</mi></mrow><annotation encoding="application/x-tex">(L,N,A)^+=U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.021331em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则为候选键</li>
<li>如果在上一步找到所有的候选键，则算法结束。否则遍历<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>Y</mi></mrow><annotation encoding="application/x-tex">Y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span></span>中任意两个三个属性与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><mi>L</mi><mo separator="true">,</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(L,N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>构成属性组，如果新属性组不包含已有的候选键且新属性组闭包为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">U</span></span></span></span>，则构成新候选键。</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406231730577.png" alt="" /></p>
<h4 id="求最小依赖集"><a class="markdownIt-Anchor" href="#求最小依赖集"></a> 求最小依赖集</h4>
<ul>
<li>F中任一函数依赖的右部仅含有一个属性。删去重复，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>C</mi><mo separator="true">,</mo><mi>A</mi><mi>B</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A\rightarrow C,AB\rightarrow C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>。后者多于</li>
<li>F中不存在这样的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，使得F与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>−</mo><mo stretchy="false">{</mo><mi>X</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">F-\{X\rightarrow A\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mclose">}</span></span></span></span>等价。</li>
<li>F中不存在这样的函数依赖<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>→</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">X\rightarrow A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>，X有真子集Z使得<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi><mo>−</mo><mo stretchy="false">{</mo><mi>X</mi><mo>→</mo><mi>A</mi><mo stretchy="false">}</mo><mo>∪</mo><mrow><mi>Z</mi><mo>→</mo><mi>A</mi></mrow></mrow><annotation encoding="application/x-tex">F-\{X\rightarrow A\}\cup {Z\rightarrow A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">A</span></span></span></span></span>与F等价。</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221642528.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221642847.png" alt="" /></p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221642533.png" alt="" /></p>
<h4 id="分解到3nf"><a class="markdownIt-Anchor" href="#分解到3nf"></a> 分解到3NF</h4>
<h5 id="保持依赖分解法"><a class="markdownIt-Anchor" href="#保持依赖分解法"></a> 保持依赖分解法</h5>
<ul>
<li>求<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">F</span></span></span></span>的最小依赖集</li>
<li>将最小依赖集中不出现的组成一个关系模式</li>
<li>将左部相同的所有函数依赖合并组成新关系</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406231917935.png" alt="" /></p>
<h5 id="既保持依赖又无损分解"><a class="markdownIt-Anchor" href="#既保持依赖又无损分解"></a> 既保持依赖，又无损分解</h5>
<ul>
<li>先求出分解到3NF保持函数依赖分解</li>
<li>求候选键，也算是一个分解</li>
<li>如果有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub><mo>⊆</mo><mi>X</mi></mrow><annotation encoding="application/x-tex">U_i\subseteq X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>，则将<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>U</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">U_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>从<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>σ</mi></mrow><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span></span></span></span>中去掉。</li>
</ul>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406231935221.png" alt="" /></p>
<h4 id="分解到bcnf"><a class="markdownIt-Anchor" href="#分解到bcnf"></a> 分解到BCNF</h4>
<p><mark>无法保证保持所有函数依赖，但保证无损连接分解</mark></p>
<ul>
<li>
<p>求候选码</p>
</li>
<li>
<p>逐个考察函数依赖</p>
</li>
<li>
<p>看能不能再分解</p>
</li>
</ul>
<blockquote>
<p>R(ABCDEG) F=(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>B</mi><mo separator="true">,</mo><mi>B</mi><mo>→</mo><mi>C</mi><mo separator="true">,</mo><mi>A</mi><mi>D</mi><mo>→</mo><mi>G</mi><mo separator="true">,</mo><mi>D</mi><mo>→</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">A\rightarrow B,B\rightarrow C,AD\rightarrow G,D\rightarrow E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>)</p>
</blockquote>
<ol>
<li>码为AD</li>
<li>分解，重新考察函数依赖（只放在有字母的里面，<mark><strong>传递依赖也要考虑完全！！！</strong></mark>）：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>B</mi><mo stretchy="false">(</mo><mi>A</mi><mo>→</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">AB(A\rightarrow B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>  ACDEG(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>D</mi><mo>→</mo><mi>G</mi><mo separator="true">,</mo><mi>D</mi><mo>→</mo><mi>E</mi><mo separator="true">,</mo><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">AD\rightarrow G,D\rightarrow E,A\rightarrow C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>)</li>
<li>只有两个的肯定是BCNF，不是的要考虑继续分解</li>
<li>ACDEG(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>D</mi><mo>→</mo><mi>G</mi><mo separator="true">,</mo><mi>D</mi><mo>→</mo><mi>E</mi><mo separator="true">,</mo><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">AD\rightarrow G,D\rightarrow E,A\rightarrow C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>)的码为AD，<strong>码要重新求</strong></li>
<li>分解<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>→</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">D\rightarrow E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>为：DE(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mo>→</mo><mi>E</mi></mrow><annotation encoding="application/x-tex">D\rightarrow E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span>)    ACDG(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>D</mi><mo>→</mo><mi>G</mi><mo separator="true">,</mo><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">AD\rightarrow G,A\rightarrow C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>)</li>
<li>重新求码为AD，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A\rightarrow C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>不满足，所以要重新分解</li>
<li>分解为：AC(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">A\rightarrow C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>)    ADG(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mi>D</mi><mo>→</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">AD\rightarrow G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">G</span></span></span></span>)</li>
<li>最终分解为：AB，DE，AC，ADG</li>
</ol>
<h4 id="判断是否保持函数依赖"><a class="markdownIt-Anchor" href="#判断是否保持函数依赖"></a> 判断是否保持函数依赖</h4>
<blockquote>
<p>直观感知：从几个分解中寻找函数依赖，看这几个函数依赖能否推出剩下的函数依赖</p>
</blockquote>
<ul>
<li>由分解找到所有的函数依赖（求闭包确定所有的别落下）并在一起为G</li>
<li>看缺哪个函数依赖</li>
<li>在G中推不在的函数依赖的闭包，如果不存在则满足函数依赖</li>
</ul>
<h4 id="判断无损连接"><a class="markdownIt-Anchor" href="#判断无损连接"></a> 判断无损连接</h4>
<p><mark>列表法</mark>证明。</p>
<ul>
<li>每个分解占一行，是则为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">a_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，不是则为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>逐个函数依赖，比如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo>→</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A\rightarrow D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>，如果有行<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">A,D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>都是a，则将其他<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>已知转化为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mn>14</mn></msub></mrow><annotation encoding="application/x-tex">b_{14}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。</li>
<li>如果只有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>，那就把所有有<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span>的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>转化为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mn>14</mn></msub></mrow><annotation encoding="application/x-tex">b_{14}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>如果<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>b</mi><mn>14</mn></msub></mrow><annotation encoding="application/x-tex">b_{14}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>能推到a,那么其他b也都能推到a</li>
</ul>
<h3 id="数据库设计"><a class="markdownIt-Anchor" href="#数据库设计"></a> 数据库设计</h3>
<p>🍰 实体：矩形框</p>
<p>🍰 属性：椭圆框并用连线连到相应实体。</p>
<p>🍰 联系：菱形框并用连线与有关的实体相连。</p>
<p>联系的元：参与联系的实体的个数。</p>
<p>联系的基数比约束：1：1，1：n，m：n（谁是1那边谁标1：领导1工人n）</p>
<p><img src="https://gitee.com/bxrbxr/images/raw/master/imgs/202406221105960.png" alt="" /></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">bubble</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2024/07/24/数据库/">http://example.com/2024/07/24/数据库/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com">bubble's blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2024/07/24/OS/"><i class="fa fa-chevron-left">  </i><span>BUAA_OS_final</span></a></div><div class="next-post pull-right"><a href="/2024/07/24/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/"><span>人工智能</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/img/background.jpg)"><div class="layout" id="footer"><div class="copyright">&copy;2024 By bubble</div><div class="framework-info"><span>驱动 - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="footer_custom_text">hitokoto</div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script src="/js/katex.js"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>